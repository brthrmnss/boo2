<!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><html><head><title>Chapter&#xA0;7.&#xA0;Real-Time Simulations</title><link rel="stylesheet" type="text/css" href="core.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="up" href="pt02.html" title="Part&#xA0;II.&#xA0;Rigid-Body Dynamics"><link rel="prev" href="pt02.html" title="Part&#xA0;II.&#xA0;Rigid-Body Dynamics"><link rel="next" href="ch08.html" title="Chapter&#xA0;8.&#xA0;Particles"></head><body>
         
        <script>
        function ok(){ 
            window.gggs()
            return;
            //$('#musicPlayer').parent().remove();
            //speakTransportPanelDialogV2.closeEmoteDialog()
            //speakTransportPanelDialog.closeEmoteDialog()
            //
            debugger
            let url = 'http://127.0.0.1:8080/uploads/extracted/' +
             'Crazy Rich Asians  Kevin Kwanepub/' +
              'jsonSets/OEBPS/Kwan_9780385536981_epub_prl_r1.htm.html.sentences.json'
            speakTransportPanelDialogV2.sideLoadSentences2(null, null, null, url)
            
        }
        setTimeout(ok, 1500)
        </script>
        <div style="background:white">````````</div><section class="chapter" title="Chapter&#xA0;7.&#xA0;Real-Time Simulations" epub:type="chapter" id="real-time_simulations"><div class="titlepage"><div><div><h2 class="title"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">1</span><span sentence-index="4711" class="">Chapter&#xA0;7.&#xA0;Real-Time  Simulations</span></span></h2></div></div></div><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">2</span><span sentence-index="4712" class="">This  chapter  is  the  first  in  a  </span></span><a id="I_indexterm1_id319702" class="indexterm"></a><a id="si7.0" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4714</span><span sentence-index="4714" class="">series  of  chapters  designed  to  give  you  a  thorough    introduction  to  the  subject  of  real-time  simulation. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">5</span><span sentence-index="4715" class=""> We  say    </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">5</span><span sentence-index="4715" class="">introduction</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">5</span><span sentence-index="4715" class=""> because  the  subject  is  too  vast  and    complex  to  adequately  treat  in  a  few  chapters;  however,  we  say    </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">5</span><span sentence-index="4715" class="">thorough</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4715</span><span sentence-index="4715" class="">  because  we&apos;ll  do  more  than  touch  on  real-time    simulations. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4716</span><span sentence-index="4716" class="">  In  fact,  we&apos;ll  walk  you  through  the  development  of  two  simple    simulations,  one  in  two  dimensions  and  the  other  in  three  dimensions.</span></span></a></p><p><a id="si7.0" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4719</span><span sentence-index="4719" class="">What  we  hope  to  do  is  give  you  enough  of  an  understanding  of  this    subject  so  that  you  can  pursue  it  further  with  confidence. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4720</span><span sentence-index="4720" class="">  In  other  words,    we  want  you  to  have  a  solid  understanding  of  the  fundamentals  before  jumping    in  to  use  someone  else&apos;s  physics  engine,  or  venturing  out  to  write  your    own.</span></span></a></p><p><a id="si7.0" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4723</span><span sentence-index="4723" class="">In  the  context  of  this  book,  a  real-time  simulation  is  a  process    whereby  you  calculate  the  state  of  the  object  (or  objects)  you&apos;re  trying  to    represent  on  the  fly. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4724</span><span sentence-index="4724" class="">  You  don&apos;t  rely  on  prescripted  motion  sequences  to    animate  your  object,  but  instead  you  rely  on  your  physics  model,  the    equations  of  motion,  and  your  differential  equation  solver  to  take  care  of    the  motion  of  your  object  as  the  simulation  progresses. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">15</span><span sentence-index="4725" class=""> This  sort  of    simulation  can  be  used  to  model  rigid  bodies  like  the  airplane  in  our    </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">15</span><span sentence-index="4725" class="">FlightSim</span></span></code><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4725</span><span sentence-index="4725" class="">  example,  or  flexible  bodies    such  as  cloth  and  human  figures. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4726</span><span sentence-index="4726" class="">  Perhaps  one  of  the  most  fundamental  aspects    of  implementing  a  real-time  rigid-body  simulator  is  solving  the  equations  of    motion  using  numerical  integration  techniques. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4727</span><span sentence-index="4727" class="">  For  this  reason,  we&apos;ll  spend    this  entire  chapter  explaining  the  numerical  integration  techniques  that    you&apos;ll  use  later  in  the  2D  and  3D  simulators  that  we&apos;ll  develop.</span></span></a></p><p><a id="si7.0" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">20</span><span sentence-index="4730" class="">If  you  refer  back  for  a  moment  to  </span></span></a><a class="xref" href="ch04.html" title="Chapter&#xA0;4.&#xA0;Kinetics"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">21</span><span sentence-index="4731" class="">Chapter&#xA0;4</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4732</span><span sentence-index="4732" class=""> ,  where    we  outlined  a  generic  procedure  for  solving  kinetics  problems,  you&apos;ll  see    that  we&apos;ve  covered  a  lot  of  ground  so  far. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4733</span><span sentence-index="4733" class="">  The  preceding  chapters  have  shown    you  how  to  estimate  mass  properties  and  develop  the  governing  equations  of    motion. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4734</span><span sentence-index="4734" class="">  This  chapter  will  show  you  how  to  solve  the  equations  of  motion  in    order  to  determine  acceleration,  velocity,  and  displacement. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4735</span><span sentence-index="4735" class="">  We&apos;ll  follow    this  chapter  up  with  several  showing  you  how  to  implement  both  2D  and  3D    rigid-body  simulations.</span></span></p><div class="sect1" title="Integrating the Equations of Motion"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="integrating_the_equations_of_motion"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">27</span><span sentence-index="4737" class="">Integrating  the  Equations  of  Motion</span></span></h2></div></div></div><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">28</span><span sentence-index="4738" class="">By  now  you  should  </span></span><a id="re7.1" class="indexterm"></a><a id="eq7.1" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4740</span><span sentence-index="4740" class="">have  a  thorough  understanding  of  the  dynamic  equations  of        motion  for  particles  and  rigid  bodies. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">31</span><span sentence-index="4741" class=""> If  not,  you  may  want  to  go  back  and        review  </span></span></a><a class="xref" href="ch01.html" title="Chapter&#xA0;1.&#xA0;Basic Concepts"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">32</span><span sentence-index="4742" class="">Chapter&#xA0;1</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">32</span><span sentence-index="4742" class=""> through  </span></span><a class="xref" href="ch04.html" title="Chapter&#xA0;4.&#xA0;Kinetics"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">34</span><span sentence-index="4744" class="">Chapter&#xA0;4</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4744</span><span sentence-index="4744" class="">  before  reading  this  one. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4745</span><span sentence-index="4745" class="">  The  next  aspect  of  dealing        with  the  equations  of  motion  is  actually  solving  them  in  your  simulation. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4746</span><span sentence-index="4746" class="">        The  equations  of  motion  that  we&apos;ve  been  discussing  can  be  classified  as        ordinary  differential  equations. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">37</span><span sentence-index="4747" class=""> In  </span></span><a class="xref" href="ch02.html" title="Chapter&#xA0;2.&#xA0;Kinematics"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">38</span><span sentence-index="4748" class="">Chapter&#xA0;2</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">38</span><span sentence-index="4748" class=""> and        </span></span><a class="xref" href="ch04.html" title="Chapter&#xA0;4.&#xA0;Kinetics"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">40</span><span sentence-index="4750" class="">Chapter&#xA0;4</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4750</span><span sentence-index="4750" class=""> ,  you  were  able  to  solve  these  differential        equations  explicitly  since  you  were  dealing  with  simple  functions  for        acceleration,  velocity,  and  displacement. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4751</span><span sentence-index="4751" class="">  This  won&apos;t  be  the  case  for  your        simulations. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4752</span><span sentence-index="4752" class="">  As  you&apos;ll  see  in  later  chapters,  force  and  moment        calculations  for  your  system  can  get  pretty  complicated  and  may  even  rely        on  tabulated  empirical  data,  which  will  prevent  you  from  writing  simple        mathematical  functions  that  can  be  easily  integrated. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4753</span><span sentence-index="4753" class="">  This  means  that  you        have  to  use  numerical  integration  techniques  to  approximately  integrate        the  equations  of  motion. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">44</span><span sentence-index="4754" class=""> We  say  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">44</span><span sentence-index="4754" class="">approximately</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4754</span><span sentence-index="4754" class="">  because        solutions  based  on  numerical  integration  won&apos;t  be  exact  and  will  have  a        certain  amount  of  error  depending  on  the  chosen  method.</span></span></p><p><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4756</span><span sentence-index="4756" class="">We&apos;re  going  to  start  with  a  rather  informal  explanation  of  how  we&apos;ll        apply  numerical  integration  because  it  will  be  easier  to  grasp. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4757</span><span sentence-index="4757" class="">  Later        we&apos;ll  get  into  some  of  the  formal  mathematics. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">48</span><span sentence-index="4758" class=""> Take  a  look  at  the        differential  equation  of  linear  motion  for  a  particle  (or  rigid  body&apos;s        center  of  mass):</span></span></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">48</span><span sentence-index="4758" class="">F  =  m  dv/dt</span></span></td></tr></tbody></table><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="4759" class="">Recall  that  this  equation  is  a  statement  of  force  equals  mass  times  acceleration,  where                </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="4759" class="">F</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="4759" class=""> is  force,  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="4759" class="">m</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="4759" class=""> is  mass,  and                </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="4759" class="">dv</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="4759" class="">/</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="4759" class="">dt</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4759</span><span sentence-index="4759" class="">  is  the  time  derivative  of  velocity,  which  is            acceleration. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">50</span><span sentence-index="4760" class=""> In  the  simple  examples  of  the  earlier  chapters  of  this  book,  we  rewrote  this            equation  in  the  following  form  so  it  could  be  integrated  explicitly:</span></span></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">50</span><span sentence-index="4760" class="">dv/dt  =  F/m</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">50</span><span sentence-index="4760" class="">dv  =  (F/m)  dt</span></span></td></tr></tbody></table><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="4761" class="">One  way  to  interpret  this  equation  is  that  an  infinitesimally  small        change  in  velocity,  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="4761" class="">dv</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="4761" class="">,  is  equal  to        (</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="4761" class="">F</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="4761" class="">/</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="4761" class="">m</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4761</span><span sentence-index="4761" class=""> )  times  an  infinitesimally        small  change  in  time. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4762</span><span sentence-index="4762" class="">  In  earlier  examples,  we  integrated  explicitly  by        taking  the  definite  integral  of  the  left  side  of  this  equation  with        respect  to  velocity  and  the  right  side  with  respect  to  time. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">53</span><span sentence-index="4763" class=""> In  numerical        integration  you  have  to  take  finite  steps  in  time,  thus        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">53</span><span sentence-index="4763" class="">dt</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">53</span><span sentence-index="4763" class=""> goes  from  being  infinitely  small  to  some  discrete        time  increment,  &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">53</span><span sentence-index="4763" class="">t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">53</span><span sentence-index="4763" class="">,  and  you  end  up  with  a  discrete        change  in  velocity,  &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">53</span><span sentence-index="4763" class="">v</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">53</span><span sentence-index="4763" class="">:</span></span></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">53</span><span sentence-index="4763" class="">&#x2206;v  =  (F/m)  &#x2206;t</span></span></td></tr></tbody></table><p><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4764</span><span sentence-index="4764" class="">It  is  important  to  notice  here  that  this  does  not  give  a  formula  for        instantaneous  velocity;  instead,  it  gives  you  only  an  approximation  of  the        change  in  velocity. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">55</span><span sentence-index="4765" class=""> Thus,  to  approximate  the  actual  velocity  of  your        particle  (or  rigid  body),  you  have  to  know  what  its  velocity  was  before        the  time  change  &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">55</span><span sentence-index="4765" class="">t</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4765</span><span sentence-index="4765" class=""> . </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4766</span><span sentence-index="4766" class="">  At  the  start  of  your  simulation,        at  time  0,  you  have  to  know  the  starting  velocity  of  your  particle. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">57</span><span sentence-index="4767" class=""> This        is  an  initial  condition  and  is  required  in  order  to  uniquely  define  your        particle&apos;s  velocity  as  you  step  </span></span><a id="I_indexterm1_id319956" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">58</span><span sentence-index="4768" class="">through  time  using  this  equation:</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">58</span><span sentence-index="4768" class="">[</span></span></sup></a><a id="CHP-7-FN-1" href="#ftn.CHP-7-FN-1" epub:type="noteref" class="footnote"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">60</span><span sentence-index="4770" class="">17</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">60</span><span sentence-index="4770" class="">]</span></span></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">60</span><span sentence-index="4770" class="">v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">60</span><span sentence-index="4770" class="">t+&#x2206;t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">60</span><span sentence-index="4770" class=""> =  v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">60</span><span sentence-index="4770" class="">t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">60</span><span sentence-index="4770" class=""> +  (F/m)            &#x2206;t</span></span></td></tr></tbody></table><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">61</span><span sentence-index="4771" class="">where  the  initial  condition  is:</span></span></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">61</span><span sentence-index="4771" class="">v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">61</span><span sentence-index="4771" class="">t=0</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">61</span><span sentence-index="4771" class=""> =  v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">61</span><span sentence-index="4771" class="">0</span></span></sub></td></tr></tbody></table><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">62</span><span sentence-index="4772" class="">Here  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">62</span><span>v</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">62</span><span>t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">62</span><span sentence-index="4772" class=""> is  velocity  at        some  time  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">62</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">62</span><span sentence-index="4772" class="">,        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">62</span><span>v</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">62</span><span sentence-index="4772" class="">t+&#x2206;t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">62</span><span sentence-index="4772" class=""> is  velocity  at  some  time        plus  the  time  step,  &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">62</span><span sentence-index="4772" class="">t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">62</span><span sentence-index="4772" class=""> is  the  time  step,  and        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">62</span><span sentence-index="4772" class="">v</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">62</span><span sentence-index="4772" class="">0</span></span></sub><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4772</span><span sentence-index="4772" class="">  is  the  initial  velocity  at        time  0.</span></span></p><p><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4774</span><span sentence-index="4774" class="">You  can  integrate  the  linear  equation  of  motion  one  more  time  in        order  to  approximate  your  particle&apos;s  displacement  (or  position). </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">65</span><span sentence-index="4775" class="nonQuoteStr"> Once        you&apos;ve  determined  the  new  velocity  value,  at  time  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">65</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">65</span><span sentence-index="4775" class="nonQuoteStr"> +        &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">65</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">65</span><span sentence-index="4775" class="nonQuoteStr">,  you  can  approximate  displacement  using:</span></span></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">65</span><span sentence-index="4775" class="nonQuoteStr">s</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">65</span><span>t+&#x2206;t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">65</span><span sentence-index="4775" class="nonQuoteStr"> =  s</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">65</span><span sentence-index="4775" class="nonQuoteStr">t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">65</span><span sentence-index="4775" class="nonQuoteStr"> +  &#x2206;t            (v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">65</span><span sentence-index="4775" class="nonQuoteStr">t+&#x2206;t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">65</span><span sentence-index="4775" class="nonQuoteStr">)</span></span></td></tr></tbody></table><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">66</span><span sentence-index="4776" class="">where  the  initial  condition  on  displacement  is:</span></span></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">66</span><span sentence-index="4776" class="">s</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">66</span><span sentence-index="4776" class="">t=0</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">66</span><span sentence-index="4776" class=""> =  s</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">66</span><span sentence-index="4776" class="">0</span></span></sub></td></tr></tbody></table><p><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4777</span><span sentence-index="4777" class="">The  integration  technique  discussed  here  is  known  as  Euler&apos;s  method,        and  it  is  the  most  basic  integration  method. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4778</span><span sentence-index="4778" class="">  While  Euler&apos;s  method  is  easy        to  grasp  and  fairly  straightforward  to  implement,  it  isn&apos;t  necessarily  the        most  accurate  method.</span></span></p><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">70</span><span sentence-index="4780" class="">You  can  reason  that  the  smaller  you  make  your  time  step&#x2014;that  is,  as                &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">70</span><span sentence-index="4780" class="">t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">70</span><span sentence-index="4780" class=""> approaches  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">70</span><span sentence-index="4780" class="">dt</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4780</span><span sentence-index="4780" class=""> &#x2014;the  closer  you&apos;ll  get  to  the            exact  solution. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4781</span><span sentence-index="4781" class="">  There  are,  however,  computational  problems  associated  with  using  very  small            time  steps. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">72</span><span sentence-index="4782" class=""> Specifically,  you&apos;ll  need  a  huge  number  of  calculations  at  very  small                &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">72</span><span sentence-index="4782" class="">t</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4782</span><span sentence-index="4782" class=""> &apos;s,  and  since  your  calculations  won&apos;t  be  exact  (depending  on            numerical  precision  you&apos;ll  be  rounding  off  and  truncating  numbers),  you&apos;ll  end  up  with  a            buildup  of  round-off  error. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4783</span><span sentence-index="4783" class="">  This  means  that  there  is  a  practical  limit  as  to  how  small  a  time            step  you  can  take. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4784</span><span sentence-index="4784" class="">  Fortunately,  there  are  several  numerical  integration  techniques  at  your            disposal  that  are  designed  to  increase  accuracy  for  reasonable  step  sizes.</span></span></p><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">76</span><span sentence-index="4786" class="">Even  though  we  used  the  linear  equation  of  motion  for  a  particle,        this  integration  technique  (and  the  ones  we&apos;ll  show  you  later)  applies        equally  well  to  the  angular  equations  of  </span></span><a id="I_indexterm1_id320129" class="indexterm"></a><a id="I_indexterm1_id320139" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4788</span><span sentence-index="4788" class="">motion.</span></span></a></p></div><div class="sect1" title="Euler&#x2019;s Method"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="euleras_method"><a id="I_indexterm1_id320139" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">81</span><span sentence-index="4791" class="">Euler&apos;s  Method</span></span></a></h2></div></div></div><p><a id="I_indexterm1_id320139" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">83</span><span sentence-index="4793" class="">The  preceding  </span></span></a><a id="re7.2" class="indexterm"></a><a id="eu7.2" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4795</span><span sentence-index="4795" class="">explanation  of  Euler&apos;s  method  was,  as  we  said,  informal. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">86</span><span sentence-index="4796" class=""> To        treat  Euler&apos;s  method  in  a  more  mathematically  rigorous  way,  we&apos;ll  look  at        the  Taylor  series  expansion  of  a  general  function,        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">86</span><span sentence-index="4796" class="">y</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">86</span><span sentence-index="4796" class="">(</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">86</span><span sentence-index="4796" class="">x</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4796</span><span sentence-index="4796" class=""> ). </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">87</span><span sentence-index="4797" class=""> Taylor&apos;s  theorem</span></span></a><a id="I_indexterm1_id320206" class="indexterm"></a><a id="I_indexterm1_id320212" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4799</span><span sentence-index="4799" class="">  lets  you  approximate  the  value  of  a  function  at  some  point        by  knowing  something  about  that  function  and  its  derivatives  at  some  other        point. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">90</span><span sentence-index="4800" class=""> This  approximation  is  expressed  as  an  infinite  polynomial  series  of        the  form:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">90</span><span sentence-index="4800" class="">y(x  +  &#x2206;x)  =  y(x)  +  (&#x2206;x)  y&apos;(x)  +            ((&#x2206;x)</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">90</span><span sentence-index="4800" class="">2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">90</span><span sentence-index="4800" class=""> /  2!)  y&apos;&apos;(x)  +            ((&#x2206;x)</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">90</span><span sentence-index="4800" class="">3</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">90</span><span sentence-index="4800" class=""> /  3!)  y&apos;&apos;&apos;(x)  +  &#xB7;  &#xB7;  &#xB7;</span></span></td></tr></tbody></table><p><a id="I_indexterm1_id320212" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span sentence-index="4802" class="">where  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span>y</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span sentence-index="4802" class=""> is  some  function  of        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span>x</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span sentence-index="4802" class="">,  (x  +  &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span>x</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span sentence-index="4802" class="">)  is  the  new  value  of        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span sentence-index="4802" class="">x</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span sentence-index="4802" class=""> at  which  you  want  to  approximate        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span>y</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span>,  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span>y</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span sentence-index="4802" class="">&apos;  is  the  first  derivative  of        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span>y</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span sentence-index="4802" class="">,  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span>y</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span sentence-index="4802" class="">&apos;&apos;  is  the  second  derivative        of  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span sentence-index="4802" class="">y</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4802</span><span sentence-index="4802" class=""> ,  and  so  on.</span></span></a></p><p><a id="I_indexterm1_id320212" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4805</span><span sentence-index="4805" class="">In  the  case  of  the  equation  of  motion  discussed  in  the  preceding        section,  the  function  that  you  are  trying  to  approximate  is  the  velocity        as  a  function  of  time. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span sentence-index="4806" class=""> Thus,  you  can  write        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span sentence-index="4806" class="">v</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span>(</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span sentence-index="4806" class="">t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span sentence-index="4806" class="">)  instead  of        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span sentence-index="4806" class="">y</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span sentence-index="4806" class="">(</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span sentence-index="4806" class="">x</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span sentence-index="4806" class="">),  which  yields  the  Taylor        expansion:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span sentence-index="4806" class="">v(t  +  &#x2206;t)  =  v(t)  +  (&#x2206;t)  v&apos;(t)  +            ((&#x2206;t)</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span sentence-index="4806" class="">2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span sentence-index="4806" class=""> /  2!)  v&apos;&apos;(t)  +            ((&#x2206;t)</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span sentence-index="4806" class="">3</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">96</span><span sentence-index="4806" class=""> /  3!)  v&apos;&apos;&apos;(t)  +  &#xB7;  &#xB7;  &#xB7;</span></span></td></tr></tbody></table><p><a id="I_indexterm1_id320212" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">98</span><span sentence-index="4808" class="">Note  here  that  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">98</span><span sentence-index="4808" class="">v</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">98</span><span sentence-index="4808" class="">&apos;(</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">98</span><span sentence-index="4808" class="">t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">98</span><span sentence-index="4808" class="">)  is        equal  to  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">98</span><span sentence-index="4808" class="">dv</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">98</span><span>/</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">98</span><span sentence-index="4808" class="">dt</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">98</span><span sentence-index="4808" class="">,  which  equals        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">98</span><span sentence-index="4808" class="">F</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">98</span><span sentence-index="4808" class="">/</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">98</span><span sentence-index="4808" class="">m</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4808</span><span sentence-index="4808" class="">  in  the  example  equation  of        motion  discussed  in  the  preceding  section. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">99</span><span sentence-index="4809" class=""> Note  also  that  you  know  the        value  of  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">99</span><span sentence-index="4809" class="">v</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">99</span><span sentence-index="4809" class=""> at  time  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">99</span><span sentence-index="4809" class="">t</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4809</span><span sentence-index="4809" class=""> . </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">100</span><span sentence-index="4810" class=""> What  you        want  to  find  is  the  value  of  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">100</span><span>v</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">100</span><span sentence-index="4810" class=""> at  time        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">100</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">100</span><span sentence-index="4810" class=""> +  &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">100</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">100</span><span sentence-index="4810" class=""> knowing        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">100</span><span sentence-index="4810" class="">v</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">100</span><span sentence-index="4810" class=""> at  time  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">100</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">100</span><span sentence-index="4810" class=""> and  its  derivative        at  time  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">100</span><span sentence-index="4810" class="">t</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4810</span><span sentence-index="4810" class=""> . </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">101</span><span sentence-index="4811" class=""> As  a  first  approximation,  and  since  you        don&apos;t  know  anything  about  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">101</span><span>v</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">101</span><span sentence-index="4811" class="">&apos;s  second,  third,  or        higher  derivatives,  you  can  truncate  the  polynomial  series  after  the  term        (&#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">101</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">101</span><span sentence-index="4811" class="">)  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">101</span><span sentence-index="4811" class="">v</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">101</span><span sentence-index="4811" class="">&apos;(</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">101</span><span sentence-index="4811" class="">t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">101</span><span sentence-index="4811" class="">),        which  yields:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">101</span><span sentence-index="4811" class="">v(t  +  &#x2206;t)  =  v(t)  +  (&#x2206;t)  v&apos;(t)</span></span></td></tr></tbody></table><p><a id="I_indexterm1_id320212" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4813</span><span sentence-index="4813" class="">This  is  the  Euler  integration  formula  that  you  saw  in  the  last        section. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">104</span><span sentence-index="4814" class=""> Since  Euler&apos;s  formula  goes  out  only  to  the  term  that  includes  the        first  derivative,  the  rest  of  the  series  that  was  left  off</span></span></a><a id="tr7.2" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">105</span><span sentence-index="4815" class=""> is  the  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">105</span><span sentence-index="4815" class="">truncation  error</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4816</span><span sentence-index="4816" class=""> . </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="4817" class=""> These  terms        that  were  left  off  are  called</span></span></a><a id="I_indexterm1_id320424" class="indexterm"> <span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">108</span><span sentence-index="4818" class="">higher-order  terms</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4819</span><span sentence-index="4819" class=""> ,  and  getting  rid  of        them  results  in  a  first-order  approximation. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4820</span><span sentence-index="4820" class="">  The  rationale  behind  this        approximation  is  that  the  further  you  go  in  the  series,  the  smaller  the        terms  and  the  less  influence  they  have  on  the  approximation. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="4821" class=""> Since        &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="4821" class=""> is  presumed  to  be  a  small  number,        &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span>t</span></span></em></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="4821" class="">2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="4821" class=""> is  even  smaller,        &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span>t</span></span></em></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="4821" class="">3</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="4821" class=""> even  smaller,  and  so        on,  and  since  these  &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="4821" class="">t</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4821</span><span sentence-index="4821" class="">  terms  appear  in  the        numerators,  each  successively  higher-order  term  gets  smaller  and  smaller. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span sentence-index="4822" class="">       In  this  case,  the  first  truncated  term,        ((&#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span>)</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span>2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span sentence-index="4822" class=""> /        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span>2</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span sentence-index="4822" class="">!)  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span sentence-index="4822" class="">v</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span sentence-index="4822" class="">&apos;&apos;(</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span sentence-index="4822" class="">),        dominates  the  truncation  error,  and  this  method  is  said  to  have  an  error        of  order  (&#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span sentence-index="4822" class="">t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span sentence-index="4822" class="">)</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">112</span><span sentence-index="4822" class="">2</span></span></sup><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4822</span><span sentence-index="4822" class=""> .</span></span></a></p><p><a id="I_indexterm1_id320424" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4825</span><span sentence-index="4825" class="">Geometrically,  Euler&apos;s  method  approximates  a  new  value,  at  the        current  step,  for  the  function  under  consideration  by  extrapolating  in  the        direction  of  the  derivative  of  the  function  at  the  previous  step. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">116</span><span sentence-index="4826" class=""> This  is        illustrated  in  </span></span></a><a class="xref" href="ch07.html#euler_integration_step" title="Figure&#xA0;7-1.&#xA0;Euler integration step"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">117</span><span sentence-index="4827" class="">Figure&#xA0;7-1</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4828</span><span sentence-index="4828" class=""> .</span></span></p><div class="figure"><a id="euler_integration_step"></a><div class="figure-contents"><a id="euler_integration_step"></a><div class="mediaobject"><a id="euler_integration_step"></a><a id="I_mediaobject1_id320505"><img src="httpatomoreillycomsourceoreillyimages1598926.png" alt="Euler integration step"></a></div></div><div class="figure-title"><a id="I_mediaobject1_id320505"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">124</span><span sentence-index="4834" class="">Figure&#xA0;7-1.&#xA0;Euler  integration  step</span></span></a></div></div><p><a class="xref" href="ch07.html#euler_integration_step" title="Figure&#xA0;7-1.&#xA0;Euler integration step"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">126</span><span sentence-index="4836" class="">Figure&#xA0;7-1</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4836</span><span sentence-index="4836" class="">  illustrates  the  truncation  error  and  shows  that            Euler&apos;s  method  will  result  in  a  polygonal  approximation  of  the  smooth  function  under            consideration. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4837</span><span sentence-index="4837" class="">  Clearly,  if  you  decrease  the  step  size,  you  increase  the  number  of  polygonal            segments  and  better  approximate  the  function. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4838</span><span sentence-index="4838" class="">  As  we  said  before,  though,  this  isn&apos;t  always            efficient  to  do  since  the  number  of  computations  in  your  simulation  will  increase  and            round-off  error  will  accumulate  more  rapidly.</span></span></p><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">130</span><span sentence-index="4840" class="">To  illustrate  Euler&apos;s  method  in  practice,  let&apos;s  examine  the  linear        equation  of  motion  for  the  ship  example  of  </span></span><a class="xref" href="ch04.html" title="Chapter&#xA0;4.&#xA0;Kinetics"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">131</span><span sentence-index="4841" class="">Chapter&#xA0;4</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">131</span><span sentence-index="4841" class="">:</span></span></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">131</span><span sentence-index="4841" class="">T  &#x2013;  (C  v)  =  ma</span></span></td></tr></tbody></table><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">133</span><span sentence-index="4843" class="">where  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">133</span><span sentence-index="4843" class="">T</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">133</span><span sentence-index="4843" class=""> is  the  propeller&apos;s  thrust,        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">133</span><span sentence-index="4843" class="">C</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">133</span><span sentence-index="4843" class=""> is  a  drag  coefficient,  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">133</span><span sentence-index="4843" class="">v</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">133</span><span sentence-index="4843" class=""> is        the  ship&apos;s  velocity,  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">133</span><span sentence-index="4843" class="">m</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">133</span><span sentence-index="4843" class=""> its  mass,  and        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">133</span><span sentence-index="4843" class="">a</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4843</span><span sentence-index="4843" class="">  its  acceleration.</span></span></p><p><a class="xref" href="ch07.html#euler_integration_comparison" title="Figure&#xA0;7-2.&#xA0;Euler integration comparison"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">136</span><span sentence-index="4846" class="">Figure&#xA0;7-2</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">136</span><span sentence-index="4846" class=""> shows  the  Euler        integration  solution,  using  a  0.5s  time  step,  superimposed  over  the  exact        solution  derived  in  </span></span><a class="xref" href="ch04.html" title="Chapter&#xA0;4.&#xA0;Kinetics"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">137</span><span sentence-index="4847" class="">Chapter&#xA0;4</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4848</span><span sentence-index="4848" class="">  for  the  ship&apos;s  speed  over        time.</span></span></p><div class="figure"><a id="euler_integration_comparison"></a><div class="figure-contents"><a id="euler_integration_comparison"></a><div class="mediaobject"><a id="euler_integration_comparison"></a><a id="I_mediaobject1_id320600"><img src="httpatomoreillycomsourceoreillyimages1598927.png" alt="Euler integration comparison"></a></div></div><div class="figure-title"><a id="I_mediaobject1_id320600"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">144</span><span sentence-index="4854" class="">Figure&#xA0;7-2.&#xA0;Euler  integration  comparison</span></span></a></div></div><p><a id="I_mediaobject1_id320600"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4856</span><span sentence-index="4856" class="">Zooming  in  on  this  graph  allows  you  to  see  the  error  in  the  Euler        approximation. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">147</span><span sentence-index="4857" class=""> This  is  shown  in  </span></span></a><a class="xref" href="ch07.html#euler_error" title="Figure&#xA0;7-3.&#xA0;Euler error"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="4858" class="">Figure&#xA0;7-3</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4859</span><span sentence-index="4859" class=""> .</span></span></p><div class="figure"><a id="euler_error"></a><div class="figure-contents"><a id="euler_error"></a><div class="mediaobject"><a id="euler_error"></a><a id="I_mediaobject1_id320637"><img src="httpatomoreillycomsourceoreillyimages1598928.png" alt="Euler error"></a></div></div><div class="figure-title"><a id="I_mediaobject1_id320637"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">155</span><span sentence-index="4865" class="nonQuoteStr">Figure&#xA0;7-3.&#xA0;Euler  error</span></span></a></div></div><p><a class="xref" href="ch07.html#exact_solution_versus_euler_solution" title="Table&#xA0;7-1.&#xA0;Exact solution versus Euler solution"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">157</span><span sentence-index="4867" class="">Table&#xA0;7-1</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">157</span><span sentence-index="4867" class=""> shows  the        numerical  values  of  speed  versus  time  for  the  range  shown  in  </span></span><a class="xref" href="ch07.html#euler_error" title="Figure&#xA0;7-3.&#xA0;Euler error"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">158</span><span sentence-index="4868" class="">Figure&#xA0;7-3</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4869</span><span sentence-index="4869" class=""> . </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">160</span><span sentence-index="4870" class=""> Also  shown  in  </span></span><a class="xref" href="ch07.html#exact_solution_versus_euler_solution" title="Table&#xA0;7-1.&#xA0;Exact solution versus Euler solution"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">161</span><span sentence-index="4871" class="">Table&#xA0;7-1</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4872</span><span sentence-index="4872" class="">  is  the  percent        difference,  the  error,  between  the  exact  solution  and  the  Euler  solution        at  each  time  step.</span></span></p><div class="table"><a id="exact_solution_versus_euler_solution"><div class="table-title"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">164</span><span sentence-index="4874" class="nonQuoteStr">Table&#xA0;7-1.&#xA0;Exact  solution  versus  Euler  solution</span></span></div><div class="table-contents"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col1"><col class="col2"><col class="col3"><col class="col4"></colgroup><thead><tr><td style="text-align: center; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">165</span><span sentence-index="4875" class="">Time                        (s)</span></span></p></td><td style="text-align: center; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">166</span><span sentence-index="4876" class="">Velocity,  exact                        (m/s)</span></span></p></td><td style="text-align: center; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">167</span><span sentence-index="4877" class="">Velocity,  Euler                        (m/s)</span></span></p></td><td style="text-align: center; vertical-align: bottom; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">168</span><span sentence-index="4878" class="nonQuoteStr">Error</span></span></p></td></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">169</span><span sentence-index="4879" class="">6.5</span></span></p></td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">170</span><span sentence-index="4880" class="">9.559084</span></span></p></td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">171</span><span sentence-index="4881" class="">9.733158</span></span></p></td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">172</span><span sentence-index="4882" class="">1.82%</span></span></p></td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">173</span><span sentence-index="4883" class="">7</span></span></p></td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">174</span><span sentence-index="4884" class="">10.06829</span></span></p></td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">175</span><span sentence-index="4885" class="">10.2465</span></span></p></td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">176</span><span sentence-index="4886" class="">1.77%</span></span></p></td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">177</span><span sentence-index="4887" class="">7.5</span></span></p></td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">178</span><span sentence-index="4888" class="">10.55267</span></span></p></td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">179</span><span sentence-index="4889" class="">10.73418</span></span></p></td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">180</span><span sentence-index="4890" class="">1.72%</span></span></p></td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">181</span><span sentence-index="4891" class="">8</span></span></p></td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">182</span><span sentence-index="4892" class="">11.01342</span></span></p></td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">183</span><span sentence-index="4893" class="">11.19747</span></span></p></td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">184</span><span sentence-index="4894" class="">1.67%</span></span></p></td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">185</span><span sentence-index="4895" class="">8.5</span></span></p></td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">186</span><span sentence-index="4896" class="">11.4517</span></span></p></td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">187</span><span sentence-index="4897" class="">11.63759</span></span></p></td><td style="text-align: left; vertical-align: top; "><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">188</span><span sentence-index="4898" class="">1.62%</span></span></p></td></tr></tbody></table></div></a></div><p><a id="exact_solution_versus_euler_solution"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4900</span><span sentence-index="4900" class="">As  you  can  see,  the  truncation  error  in  this  example  isn&apos;t  too  bad. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4901</span><span sentence-index="4901" class="">        It  could  be  better,  though,  and  we&apos;ll  show  you  some  more  accurate  methods        in  a  moment. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">192</span><span sentence-index="4902" class=""> Before  that,  however,  you  should  notice  that  in  this  example        Euler&apos;s  method  is  also  stable&#x2014;that  is,  it  converges  well  with  the  exact        solution  as  shown  in  </span></span></a><a class="xref" href="ch07.html#convergence" title="Figure&#xA0;7-4.&#xA0;Convergence"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">193</span><span sentence-index="4903" class="">Figure&#xA0;7-4</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">193</span><span sentence-index="4903" class="">,  where  we&apos;ve  carried        the  time  </span></span><a id="I_indexterm1_id320986" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4905</span><span sentence-index="4905" class="">range  out  further.</span></span></a></p><div class="figure"><a id="convergence"></a><div class="figure-contents"><a id="convergence"></a><div class="mediaobject"><a id="convergence"></a><a id="I_mediaobject1_id321009"><img src="httpatomoreillycomsourceoreillyimages1598929.png" alt="Convergence"></a></div></div><div class="figure-title"><a id="I_mediaobject1_id321009"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">201</span><span sentence-index="4911" class="">Figure&#xA0;7-4.&#xA0;Convergence</span></span></a></div></div><p><a id="I_mediaobject1_id321009"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">203</span><span sentence-index="4913" class="">Here&apos;s  a  code  snippet  that  implements  Euler&apos;s  method  for  this        example:</span></span></a></p><a id="I_programlisting1_id321030"><pre class="programlisting">// Global Variables
float     T;     // thrust
float     C;     // drag coefficient
float     V;     // velocity
float     M;     // mass
float     S;     // displacement

.
.
.

// This function progresses the simulation by dt seconds using
// Euler&apos;s basic method
void StepSimulation(float dt)
{
     float     F;     // total force
     float     A;     // acceleration
     float     Vnew;  // new velocity at time t + dt
     float     Snew;  // new position at time t + dt

     // Calculate the total force
     F = (T &#x2212; (C * V));

     // Calculate the acceleration
     A = F / M;

     // Calculate the new velocity at time t + dt
     // where V is the velocity at time t
     Vnew = V + A * dt;

     // Calculate the new displacement at time t + dt
     // where S is the displacement at time t
     Snew = S + Vnew * dt;

     // Update old velocity and displacement with the new ones
     V = Vnew;
     S = Snew;
}</pre><p><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4915</span><span sentence-index="4915" class="">Although  Euler&apos;s  method  is  stable  in  this  example,  that  isn&apos;t  always  so,  depending  on  the            problem  you&apos;re  trying  to  solve. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4916</span><span sentence-index="4916" class="">  This  is  something  that  you  must  keep  in  mind  when  implementing            any  numerical  integration  scheme. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">207</span><span sentence-index="4917" class=""> What  we  mean  by  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">207</span><span sentence-index="4917" class="">stable</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4917</span><span sentence-index="4917" class="">  here  is  that,  in            this  case,  the  Euler  solution  converges  with  the  exact  solution. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4918</span><span sentence-index="4918" class="">  An  unstable  solution  could            manifest  errors  in  two  ways. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4919</span><span sentence-index="4919" class="">  First,  successive  values  could  oscillate  above  and  below  the            exact  solution,  never  quite  converging  on  it. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4920</span><span sentence-index="4920" class="">  Second,  successive  values  could  diverge  from  the            exact  solution,  creating  a  greater  and  greater  error  over  time.</span></span></p></a><p><a id="I_programlisting1_id321030"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">213</span><span sentence-index="4923" class="">Take  a  look  at  </span></span></a><a class="xref" href="ch07.html#unstable_results_using_euleras_method" title="Figure&#xA0;7-5.&#xA0;Unstable results using Euler&#x2019;s method"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">214</span><span sentence-index="4924" class="">Figure&#xA0;7-5</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4925</span><span sentence-index="4925" class=""> . </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4926</span><span sentence-index="4926" class="">  This  figure  shows  how        Euler&apos;s  method  can  become  very  unstable. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4927</span><span sentence-index="4927" class="">  What  you  see  in  the  graph        represents  the  vibratory  motion  of  a  spring-mass  system. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4928</span><span sentence-index="4928" class="">  This  is  a  simple        dynamical  system  that  should  exhibit  regular  sinusoidal  motion.</span></span></p><div class="figure"><a id="unstable_results_using_euleras_method"></a><div class="figure-contents"><a id="unstable_results_using_euleras_method"></a><div class="mediaobject"><a id="unstable_results_using_euleras_method"></a><a id="I_mediaobject1_id321077"><img src="httpatomoreillycomsourceoreillyimages1598930.png" alt="Unstable results using Euler&#x2019;s method"></a></div></div><div class="figure-title"><a id="I_mediaobject1_id321077"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">224</span><span sentence-index="4934" class="">Figure&#xA0;7-5.&#xA0;Unstable  results  using  Euler&apos;s  method</span></span></a></div></div><p><a id="I_mediaobject1_id321077"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4936</span><span sentence-index="4936" class="">It&apos;s  clear  from  the  figure  that  using  Euler&apos;s  method  yields  terribly        unstable  results. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4937</span><span sentence-index="4937" class="">  You  can  see  how  the  motion  amplitude  continues  to  grow. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4938</span><span sentence-index="4938" class="">        If  this  were  a  game,  say,  where  you  have  a  few  objects  connected  by        springs  interacting  with  one  another,  then  this  sort  of  instability  would        manifest  itself  by  wildly  unrealistic  motion  of  those  objects. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4939</span><span sentence-index="4939" class="">  Worse  yet,        the  simulation  could  blow  up,  numerically  speaking.</span></span></a></p><p><a id="I_mediaobject1_id321077"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4942</span><span sentence-index="4942" class="">Often,  your  choice  of  step  size  affects  stability  where  smaller  step        sizes  tend  to  eliminate  or  minimize  instability  and  larger  steps  aggravate        the  problem. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4943</span><span sentence-index="4943" class="">  If  you&apos;re  working  with  a  particularly  unwieldy  function,  you        might  find  that  you  have  to  decrease  your  step  size  substantially  in  order        to  achieve  stability. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4944</span><span sentence-index="4944" class="">  This,  however,  increases  the  number  of  computations        you  need  to  make. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="4945" class=""> One  way  around  this  difficulty  is  to  employ  what&apos;s        called  an  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="4945" class="">adaptive  step  size  method</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="4945" class="">,  in  which        </span></span></a><a id="I_indexterm1_id321116" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4946</span><span sentence-index="4946" class="">you  change  your  step  size  on  the  fly  depending  on  the        magnitude  of  a  predicted  amount  of  truncation  error  from  one  step  to  the        next. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4947</span><span sentence-index="4947" class="">  If  the  truncation  error  is  too  large,  then  you  back  up  a  step,        decrease  your  step  size,  and  try  again.</span></span></a></p><p><a id="I_indexterm1_id321116" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span sentence-index="4950" class="">One  way  to  implement  this  for  Euler&apos;s  method  is  to  first  take  a  step        of  size  &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span sentence-index="4950" class=""> to  obtain  an  estimate  at  time        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span> +  &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span sentence-index="4950" class="">,  and  then  take  two  steps        (starting  from  time  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span sentence-index="4950" class=""> again)  of  size        &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span sentence-index="4950" class="">/</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span sentence-index="4950" class="">2</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span sentence-index="4950" class=""> to  obtain  another  estimate        at  time  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span sentence-index="4950" class=""> +  &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">240</span><span sentence-index="4950" class="">t</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4950</span><span sentence-index="4950" class=""> . </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span sentence-index="4951" class=""> Since  we&apos;ve  been        talking  velocity  in  the  examples  so  far,  let&apos;s  call  the  first  estimate        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span>v</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span sentence-index="4951" class="">1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span sentence-index="4951" class=""> and  the  second  estimate        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span sentence-index="4951" class="">v</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span sentence-index="4951" class="">2</span></span></sub><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4951</span><span sentence-index="4951" class=""> .</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">242</span><span sentence-index="4952" class="">[</span></span></sup></a><a id="CHP-7-FN-2" href="#ftn.CHP-7-FN-2" epub:type="noteref" class="footnote"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">243</span><span sentence-index="4953" class="nonQuoteStr">18</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">243</span><span sentence-index="4953" class="nonQuoteStr">]  A  measure  of  the  truncation  error  is  then:</span></span></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">243</span><span sentence-index="4953" class="nonQuoteStr">e</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">243</span><span sentence-index="4953" class="nonQuoteStr">t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">243</span><span sentence-index="4953" class="nonQuoteStr"> =  |v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">243</span><span sentence-index="4953" class="nonQuoteStr">1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">243</span><span sentence-index="4953" class="nonQuoteStr"> &#x2013;            v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">243</span><span sentence-index="4953" class="nonQuoteStr">2</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">243</span><span sentence-index="4953" class="nonQuoteStr">|</span></span></td></tr></tbody></table><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span sentence-index="4955" class="nonQuoteStr">If  you  wish  to  keep  the  truncation  error  within  a  specified  limit,        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span sentence-index="4955" class="nonQuoteStr">e</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span>to</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span sentence-index="4955" class="nonQuoteStr">,  then  you  can  use  the        following  formula  to  find  out  what  your  step  size  should  be  in  order  to        maintain  the  desired  accuracy:</span></span></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span sentence-index="4955" class="nonQuoteStr">&#x2206;t</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span sentence-index="4955" class="nonQuoteStr">new</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span sentence-index="4955" class="nonQuoteStr"> =  &#x2206;t</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span sentence-index="4955" class="nonQuoteStr">old</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span sentence-index="4955" class="nonQuoteStr">           (e</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span sentence-index="4955" class="nonQuoteStr">to</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span sentence-index="4955" class="nonQuoteStr"> /  e</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span sentence-index="4955" class="nonQuoteStr">t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span sentence-index="4955" class="nonQuoteStr">)            </span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">245</span><span sentence-index="4955" class="nonQuoteStr">(1/2)</span></span></sup></td></tr></tbody></table><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">246</span><span sentence-index="4956" class="">Here,  &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">246</span><span>t</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">246</span><span sentence-index="4956" class="">old</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">246</span><span sentence-index="4956" class=""> is  the  old        time  step  and  &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">246</span><span sentence-index="4956" class="">t</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">246</span><span sentence-index="4956" class="">new</span></span></sub><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4956</span><span sentence-index="4956" class="">  is  the  new        one  that  you  should  use  to  maintain  the  desired  accuracy. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4957</span><span sentence-index="4957" class="">  You&apos;ll  have  to        make  this  check  for  each  time  step,  and  if  you  find  that  the  error        warrants  a  smaller  time  step,  then  you&apos;ll  have  to  back  up  a  step  and        repeat  it  with  the  new  time  step.</span></span></p><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">249</span><span sentence-index="4959" class="nonQuoteStr">Here&apos;s  a  revised  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">249</span><span sentence-index="4959" class="nonQuoteStr">StepSimulation</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">249</span><span sentence-index="4959" class="nonQuoteStr">       function  that  implements  this  adaptive  step  size  technique,  checking  the        truncation  error  on  </span></span><a id="I_indexterm1_id321272" class="indexterm"></a><a id="I_indexterm1_id321282" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">251</span><span sentence-index="4961" class="">the  velocity  integration:</span></span></a></p><a id="I_programlisting1_id321293"><pre class="programlisting">// New global variable
float     eto;     // truncation error tolerance

// This function progresses the simulation by dt seconds using
// Euler&apos;s basic method with an adaptive step size
void StepSimulation(float dt)
{
     float     F;     // total force
     float     A;     // acceleration
     float     Vnew;  // new velocity at time t + dt
     float     Snew;  // new position at time t + dt
     float     V1, V2; // temporary velocity variables
     float     dtnew;  // new time step
     float     et;     // truncation error

     // Take one step of size dt to estimate the new velocity
     F = (T &#x2212; (C * V));
     A = F / M;
     V1 = V + A * dt;

     // Take two steps of size dt/2 to estimate the new velocity
     F = (T &#x2212; (C * V));
     A = F / M;
     V2 = V + A * (dt/2);

     F = (T &#x2212; (C * V2));
     A = F / M;
     V2 = V2 + A * (dt/2);

     // Estimate the truncation error
     et = absf(V1 &#x2212; V2);

     // Estimate a new step size
     dtnew = dt * SQRT(eto/et);


     if (dtnew &lt; dt)
     { // take at step at the new smaller step size
          F = (T &#x2212; (C * V));
          A = F / M;
          Vnew = V + A * dtnew;
          Snew = S + Vnew * dtnew;
     } else
     { // original step size is okay
          Vnew = V1;
          Snew = S + Vnew * dt;
     }

     // Update old velocity and displacement with the new ones
     V = Vnew;
     S = Snew;
}</pre></a></div><div class="sect1" title="Better Methods"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="better_methods"><a id="I_programlisting1_id321293"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">254</span><span sentence-index="4964" class="nonQuoteStr">Better  Methods</span></span></a></h2></div></div></div><p><a id="I_programlisting1_id321293"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">256</span><span sentence-index="4966" class="">At  this  point,  you  might  </span></span></a><a id="im7.3" class="indexterm"></a><a id="eu7.3" class="indexterm"></a><a id="re7.3" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4969</span><span sentence-index="4969" class="">be  wondering  why  you  can&apos;t  simply  use  more  terms  in  the        Taylor  series  to  reduce  the  truncation  error  of  Euler&apos;s  method. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4970</span><span sentence-index="4970" class="">  In  fact,        this  is  the  basis  for  several  integration  methods  that  offer  greater        accuracy  than  Euler&apos;s  basic  method  for  a  given  step  size. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4971</span><span sentence-index="4971" class="">  Part  of  the        difficulty  associated  with  picking  up  more  terms  in  the  Taylor&apos;s  series        expansion  is  in  being  able  to  determine  the  second,  third,  fourth,  and        higher  derivatives  of  the  function  you&apos;re  trying  to  integrate. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4972</span><span sentence-index="4972" class="">  The  way        around  this  problem  is  to  perform  additional  Taylor  series  expansions  to        approximate  the  derivatives  of  the  function  under  consideration  and  then        substitute  those  values  back  into  your  original  expansion.</span></span></a></p><p><a id="re7.3" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">265</span><span sentence-index="4975" class="">Taking  this  approach  to  include  one  </span></span></a><a id="I_indexterm1_id321376" class="indexterm"></a><a id="I_indexterm1_id321382" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">267</span><span sentence-index="4977" class="">more  Taylor  term  beyond  the  basic  Euler  method  yields  a        so-called  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">267</span><span sentence-index="4977" class="">improved  Euler  method</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">267</span><span sentence-index="4977" class=""> that  has  a  reduced        truncation  error  on  the  order  of        (&#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">267</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">267</span><span>)</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">267</span><span sentence-index="4977" class="">3</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">267</span><span sentence-index="4977" class=""> instead  of        (&#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">267</span><span sentence-index="4977" class="">t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">267</span><span sentence-index="4977" class="">)</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">267</span><span sentence-index="4977" class="">2</span></span></sup><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4977</span><span sentence-index="4977" class=""> . </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span sentence-index="4978" class=""> The  formulas  for        this  method  are:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span>k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span>1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span sentence-index="4978" class=""> =  (&#x2206;t)  y&apos;(t,  y)</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span sentence-index="4978" class="">k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span>2</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span sentence-index="4978" class=""> =  (&#x2206;t)  y&apos;(t  +  &#x2206;t,  y  +            k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span>1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span>)</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span sentence-index="4978" class="">y(t  +  &#x2206;t)  =  y(t)  +  &#xBD;  (k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span sentence-index="4978" class="">1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span sentence-index="4978" class=""> +            k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span sentence-index="4978" class="">2</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">268</span><span sentence-index="4978" class="">)</span></span></td></tr></tbody></table><p><a id="I_indexterm1_id321382" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">270</span><span sentence-index="4980" class="">Here  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">270</span><span>y</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">270</span><span sentence-index="4980" class=""> is  a  function  of  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">270</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">270</span><span sentence-index="4980" class="">,        and  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">270</span><span>y</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">270</span><span sentence-index="4980" class="">&apos;  is  the  derivative  as  a  function  of        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">270</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">270</span><span sentence-index="4980" class=""> and  possibly  of  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">270</span><span sentence-index="4980" class="">y</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">270</span><span sentence-index="4980" class=""> depending  on        the  equations  you&apos;re  trying  to  solve,  and  &#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">270</span><span sentence-index="4980" class="">t</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4980</span><span sentence-index="4980" class="">  the  step        size.</span></span></a></p><p><a id="I_indexterm1_id321382" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">273</span><span sentence-index="4983" class="">To  make  this  clearer  for  you,  we&apos;ll  show  these  formulas  in  terms  of        the  ship  example  equation  of  motion  of  </span></span></a><a class="xref" href="ch04.html" title="Chapter&#xA0;4.&#xA0;Kinetics"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">274</span><span sentence-index="4984" class="">Chapter&#xA0;4</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4985</span><span sentence-index="4985" class=""> ,  the        same  example  that  we  discussed  in  the  previous  section. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class=""> In  this  case,        velocity  is  approximated  by  the  following  formulas:</span></span></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span>k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span>1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class=""> =  &#x2206;t  [1/m  (T  &#x2013;  C            v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span>t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class="">)]</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class="">k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span>2</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class=""> =  &#x2206;t  [1/m  (T  &#x2013;  C            (v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span>t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span> +  k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span>1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class="">))]</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class="">v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class="">t+&#x2206;t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class=""> =  v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class="">t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class=""> +            &#xBD;(k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class="">1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class=""> +  k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class="">2</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">276</span><span sentence-index="4986" class="">)</span></span></td></tr></tbody></table><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">277</span><span sentence-index="4987" class="">where  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">277</span><span>v</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">277</span><span>t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">277</span><span sentence-index="4987" class=""> is  the  velocity        at  time  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">277</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">277</span><span sentence-index="4987" class="">,  and        </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">277</span><span sentence-index="4987" class="">v</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">277</span><span sentence-index="4987" class="">t+&#x2206;t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">277</span><span sentence-index="4987" class=""> is  the  new  velocity  at        time  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">277</span><span>t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">277</span><span sentence-index="4987" class="">+&#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">277</span><span sentence-index="4987" class="">t</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4987</span><span sentence-index="4987" class=""> .</span></span></p><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">279</span><span sentence-index="4989" class="">Here  is  the  revised  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">279</span><span sentence-index="4989" class="">StepSimulation</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">279</span><span sentence-index="4989" class=""> function  showing  how  to  implement        this  method  in  code:</span></span></p><a id="I_programlisting1_id321573"><pre class="programlisting">// This function progresses the simulation by dt seconds using
// the &quot;improved&quot; Euler method
void StepSimulation(float dt)
{
     float     F;     // total force
     float     A;     // acceleration
     float     Vnew;  // new velocity at time t + dt
     float     Snew;  // new position at time t + dt
     float     k1, k2;


     F = (T - (C * V));
     A = F/M;
     k1 = dt * A;

     F = (T - (C * (V + k1)));
     A = F/M;
     k2 = dt * A;

     // Calculate the new velocity at time t + dt
     // where V is the velocity at time t
     Vnew = V + (k1 + k2) / 2;

     // Calculate the new displacement at time t + dt
     // where S is the displacement at time t
     Snew = S + Vnew * dt;

     // Update old velocity and displacement with the new ones
     V = Vnew;
     S = Snew;
}</pre></a><p><a id="I_programlisting1_id321573"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4992</span><span sentence-index="4992" class="">We  can  carry  out  this  procedure  of  taking  on  more  Taylor  terms  even        further. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">283</span><span sentence-index="4993" class=""> The  </span></span></a><a id="ru7.3" class="indexterm"></a><a id="ret7.3" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">285</span><span sentence-index="4995" class="">popular  Runge-Kutta  method  takes  such  an  approach  to  reduce        the  truncation  error  to  the  order  of        (&#x2206;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">285</span><span sentence-index="4995" class="">t</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">285</span><span sentence-index="4995" class="">)</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">285</span><span sentence-index="4995" class="">5</span></span></sup><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">4995</span><span sentence-index="4995" class=""> . </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class=""> The  integration        formulas  for  this  method  are  as  follows:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span>k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span>1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class=""> =  (&#x2206;t)  y&apos;(t,  y)</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span>k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span>2</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span> =  (&#x2206;t)  y&apos;(t  +  &#x2206;t/2,  y  +            k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span>1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span>/2)</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span>k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span>3</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class=""> =  (&#x2206;t)  y&apos;(t  +  &#x2206;t/2,  y  +            k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span>2</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class="">/2)</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class="">k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span>4</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class=""> =  (&#x2206;t)  y&apos;(t  +  &#x2206;t,  y  +            k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span>3</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span>)</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class="">y(t  +  &#x2206;t)  =  y(t)  +  1/6  (k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class="">1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class=""> +  2            (k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class="">2</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class="">)  +  2  (k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class="">3</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class="">)  +            k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class="">4</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="4996" class="">)</span></span></td></tr></tbody></table><p><a id="ret7.3" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">Applying  these  formulas  to  our  ship  example  yields:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class=""> =  &#x2206;t  [1/m  (T  &#x2013;  C            v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">)]</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>2</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span> =  &#x2206;t  [1/m  (T  &#x2013;  C            (v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span> +  k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>/2))]</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>3</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span> =  &#x2206;t  [1/m  (T  &#x2013;  C            (v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span> +  k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>2</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">/2))]</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>4</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class=""> =  &#x2206;t  [1/m  (T  &#x2013;  C            (v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class=""> +  k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span>3</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">))]</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">t+&#x2206;t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class=""> =  v</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">t</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class=""> +  1/6            (k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">1</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class=""> +  2  (k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">2</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">)  +  2            (k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">3</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">)  +  k</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">4</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">288</span><span sentence-index="4998" class="">)</span></span></td></tr></tbody></table><p><a id="ret7.3" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">290</span><span sentence-index="5000" class="">For  our  example,  the  Runge-Kutta  method  is  implemented  as        follows:</span></span></a></p><a id="I_programlisting1_id321789"><pre class="programlisting">// This function progresses the simulation by dt seconds using
// the Runge-Kutta method
void StepSimulation(float dt)
{
     float     F;     // total force
     float     A;     // acceleration
     float     Vnew;  // new velocity at time t + dt
     float     Snew;  // new position at time t + dt
     float     k1, k2, k3, k4;


     F = (T - (C * V));
     A = F/M;
     k1 = dt * A;

     F = (T - (C * (V + k1/2)));
     A = F/M;
     k2 = dt * A;

     F = (T - (C * (V + k2/2)));
     A = F/M;
     k3 = dt * A;

     F = (T - (C * (V + k3)));
     A = F/M;
     k4 = dt * A;

     // Calculate the new velocity at time t + dt
     // where V is the velocity at time t
     Vnew = V + (k1 + 2*k2 + 2*k3 + k4) / 6;

     // Calculate the new displacement at time t + dt
     // where S is the displacement at time t
     Snew = S + Vnew * dt;

     // Update old velocity and displacement with the new ones
     V = Vnew;
     S = Snew;
}</pre></a><p><a id="I_programlisting1_id321789"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">293</span><span sentence-index="5003" class="">To  show  you  how  accuracy  is  improved  over  the  basic  Euler  method,        we&apos;ve  superimposed  integration  results  for  the  ship  example  using  these        two  methods  over  those  shown  in  </span></span></a><a class="xref" href="ch07.html#euler_integration_comparison" title="Figure&#xA0;7-2.&#xA0;Euler integration comparison"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">294</span><span sentence-index="5004" class="">Figure&#xA0;7-2</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">294</span><span sentence-index="5004" class=""> and  </span></span><a class="xref" href="ch07.html#euler_error" title="Figure&#xA0;7-3.&#xA0;Euler error"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">296</span><span sentence-index="5006" class="">Figure&#xA0;7-3</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5006</span><span sentence-index="5006" class=""> . </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">297</span><span sentence-index="5007" class=""> </span></span><a class="xref" href="ch07.html#method_comparison" title="Figure&#xA0;7-6.&#xA0;Method comparison"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">298</span><span sentence-index="5008" class="">Figure&#xA0;7-6</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">298</span><span sentence-index="5008" class=""> and  </span></span><a class="xref" href="ch07.html#a_closer_look" title="Figure&#xA0;7-7.&#xA0;A closer look"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">299</span><span sentence-index="5009" class="">Figure&#xA0;7-7</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">299</span><span sentence-index="5009" class=""> show  the  results,  where  </span></span><a class="xref" href="ch07.html#a_closer_look" title="Figure&#xA0;7-7.&#xA0;A closer look"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">301</span><span sentence-index="5011" class="">Figure&#xA0;7-7</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5011</span><span sentence-index="5011" class="">  is  a  zoomed  view  of  7-6.</span></span></p><div class="figure"><a id="method_comparison"></a><div class="figure-contents"><a id="method_comparison"></a><div class="mediaobject"><a id="method_comparison"></a><a id="I_mediaobject1_id321842"><img src="httpatomoreillycomsourceoreillyimages1598931.png" alt="Method comparison"></a></div></div><div class="figure-title"><a id="I_mediaobject1_id321842"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">307</span><span sentence-index="5017" class="">Figure&#xA0;7-6.&#xA0;Method  comparison</span></span></a></div></div><div class="figure"><a id="a_closer_look"></a><div class="figure-contents"><a id="a_closer_look"></a><div class="mediaobject"><a id="a_closer_look"></a><a id="I_mediaobject1_id321871"><img src="httpatomoreillycomsourceoreillyimages1598932.png" alt="A closer look"></a></div></div><div class="figure-title"><a id="I_mediaobject1_id321871"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">312</span><span sentence-index="5022" class="">Figure&#xA0;7-7.&#xA0;A  closer  look</span></span></a></div></div><p><a id="I_mediaobject1_id321871"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5024</span><span sentence-index="5024" class="">As  you  can  see  from  these  figures,  it&apos;s  impossible  to  discern  the  curves  for  the  improved            Euler  and  Runge-Kutta  methods  from  the  exact  solution  because  they  fall  almost  right  on  top  of            each  other. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5025</span><span sentence-index="5025" class="">  These  results  clearly  show  the  improvement  in  accuracy  over  the  basic  Euler            method,  whose  curve  is  distinct  from  the  other  three. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">316</span><span sentence-index="5026" class=""> Over  the  interval  from  6.5  to  8.5            seconds,  the  average  truncation  error  is  1.72%,  0.03%,  and            3.6&#xD7;10</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">316</span><span sentence-index="5026" class="">&#x2212;6</span></span></sup><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5026</span><span sentence-index="5026" class=""> %  for  Euler&apos;s  method,  the  improved  Euler  method,  the            Runge-Kutta  method,  respectively. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5027</span><span sentence-index="5027" class="">  It  is  obvious,  based  on  these  results,  that  for  this            problem,  the  Runge-Kutta  method  yields  substantially  better  results  for  a  given  step  size  than            the  other  two  methods. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5028</span><span sentence-index="5028" class="">  Of  course,  you  pay  for  this  accuracy,  since  you  have  several  more            computations  per  step  in  the  Runge-Kutta  method.</span></span></a></p><p><a id="I_mediaobject1_id321871"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5031</span><span sentence-index="5031" class="">Both  of  these  methods  are  generally  more  stable  than  Euler&apos;s  method,        which  is  a  huge  benefit  in  real-time  applications. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5032</span><span sentence-index="5032" class="">  Recall  our  discussion        earlier  about  the  stability  of  Euler&apos;s  method. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">323</span><span sentence-index="5033" class=""> </span></span></a><a class="xref" href="ch07.html#unstable_results_using_euleras_method" title="Figure&#xA0;7-5.&#xA0;Unstable results using Euler&#x2019;s method"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">324</span><span sentence-index="5034" class="">Figure&#xA0;7-5</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5035</span><span sentence-index="5035" class="">  showed  the  results  of        applying  Euler&apos;s  method  to  an  oscillating  dynamical  system. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5036</span><span sentence-index="5036" class="">  There,  the        motion  results  that  should  be  sinusoidal  were  wildly  erratic  (i.e.,        unstable). </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">327</span><span sentence-index="5037" class=""> Applying  the  improved  Euler  method,  or  the  Runge-Kutta  method,        to  the  same  problem  yields  stable  results,  as  shown  in  </span></span><a class="xref" href="ch07.html#stable_results_using_the_improved_euler" title="Figure&#xA0;7-8.&#xA0;Stable results using the improved Euler or the Runge-Kutta methods"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">328</span><span sentence-index="5038" class="">Figure&#xA0;7-8</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5039</span><span sentence-index="5039" class=""> .</span></span></p><div class="figure"><a id="stable_results_using_the_improved_euler"></a><div class="figure-contents"><a id="stable_results_using_the_improved_euler"></a><div class="mediaobject"><a id="stable_results_using_the_improved_euler"></a><a id="I_mediaobject1_id321932"><img src="httpatomoreillycomsourceoreillyimages1598933.png" alt="Stable results using the improved Euler or the Runge-Kutta methods"></a></div></div><div class="figure-title"><a id="I_mediaobject1_id321932"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">335</span><span sentence-index="5045" class="nonQuoteStr">Figure&#xA0;7-8.&#xA0;Stable  results  using  the  improved  Euler  or  the  Runge-Kutta            methods</span></span></a></div></div><p><a id="I_mediaobject1_id321932"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5047</span><span sentence-index="5047" class="">Here  the  oscillatory  motion  is  clearly  sinusoidal,  as  it  should  be. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5048</span><span sentence-index="5048" class="">        The  results  for  this  particular  problem  are  almost  identical  whether  you        use  the  improved  Euler  method  or  the  Runge-Kutta  method. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5049</span><span sentence-index="5049" class="">  Since  for  this        problem  the  results  of  both  methods  are  virtually  the  same,  you  can  save        computational  time  and  memory  using  the  improved  Euler  method  versus  the        Runge-Kutta  method. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5050</span><span sentence-index="5050" class="">  This  can  be  a  significant  advantage  for  real-time        games. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5051</span><span sentence-index="5051" class="">  Remember  the  Runge-Kutta  method  requires  four  derivative        computations  per  time  step.</span></span></a></p><p><a id="I_mediaobject1_id321932"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5054</span><span sentence-index="5054" class="">These  methods  aren&apos;t  the  only  ones  at  your  disposal,  but  they  are  the  most  common. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5055</span><span sentence-index="5055" class="">  The            Runge-Kutta  method  is  particularly  popular  as  a  general-purpose  numerical  integration  scheme. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5056</span><span sentence-index="5056" class="">            Other  methods  attempt  to  improve  computational  efficiency  even  further&#x2014;that  is,  they  are            designed  to  minimize  truncation  error  while  still  allowing  you  to  take  relatively  large  step            sizes  so  as  to  reduce  the  number  of  steps  you  have  to  take  in  your  integration. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5057</span><span sentence-index="5057" class="">  Still  other            methods  are  especially  tailored  for  specific  problem  types. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">348</span><span sentence-index="5058" class=""> We  cite  some  pretty  good            references  for  further  reading  on  this  subject  in  the  </span></span></a><a id="I_indexterm1_id321970" class="indexterm"></a><a id="I_indexterm1_id321980" class="indexterm"></a><a id="I_indexterm1_id321989" class="indexterm"></a><a id="I_indexterm1_id321998" class="indexterm"></a><a id="I_indexterm1_id322008" class="indexterm"></a><a class="link" href="apd.html" title="Appendix&#xA0;D.&#xA0;Bibliography"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">354</span><span sentence-index="5064" class="">Bibliography</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5064</span><span sentence-index="5064" class=""> .</span></span></p></div><div class="sect1" title="Summary"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="summary-id1"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">356</span><span sentence-index="5066" class="">Summary</span></span></h2></div></div></div><p><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5067</span><span sentence-index="5067" class="">At  this  point  you  should  be  comfortable  with  the  terms  that  appear  in  the  equations  of            motion  and  be  able  to  calculate  terms  like  the  sum  of  forces  and  moments,  mass,  and  inertia. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5068</span><span sentence-index="5068" class="">            You  should  also  have  a  solid  understanding  of  basic  numerical  integration  techniques. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5069</span><span sentence-index="5069" class="">            Implementing  these  techniques  in  code  is  really  straightforward  since  they  are  composed  of            simple  polynomial  functions. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5070</span><span sentence-index="5070" class="">  The  hard  part  is  developing  the  derivative  function  for  your            problem. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5071</span><span sentence-index="5071" class="">  In  the  case  of  the  equations  of  motion,  the  derivative  function  will  include  all  your            force  and  moment  calculations  for  the  particle  or  rigid  body  that  you  are  modeling. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">362</span><span sentence-index="5072" class=""> You&apos;ll  see            some  more  numerical  integration  </span></span><a id="I_indexterm1_id322037" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">363</span><span sentence-index="5073" class="">code  when  you  get  to  </span></span></a><a class="xref" href="ch08.html" title="Chapter&#xA0;8.&#xA0;Particles"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">365</span><span sentence-index="5075" class="">Chapter&#xA0;8</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">365</span><span sentence-index="5075" class="">,  </span></span><a class="xref" href="ch09.html" title="Chapter&#xA0;9.&#xA0;2D Rigid-Body Simulator"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">366</span><span sentence-index="5076" class="">Chapter&#xA0;9</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">366</span><span sentence-index="5076" class="">,  and  </span></span><a class="xref" href="ch11.html" title="Chapter&#xA0;11.&#xA0;Rotation in 3D Rigid-Body Simulators"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">368</span><span sentence-index="5078" class="">Chapter&#xA0;11</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5078</span><span sentence-index="5078" class=""> .</span></span></p></div><div class="footnotes" epub:type="footnotes"><br><hr style="width: 100; align: left;"><div class="footnote" epub:type="footnote" id="ftn.CHP-7-FN-1"><p><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">371</span><span sentence-index="5081" class="">[</span></span><a href="#CHP-7-FN-1" class="para"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">372</span><span sentence-index="5082" class="">17</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">372</span><span sentence-index="5082" class="">]  </span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">372</span><span sentence-index="5082" class="">In  mathematics,  this  sort  of  problem  is  termed  an                </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">372</span><span sentence-index="5082" class="">initial  value  problem</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5083</span><span sentence-index="5083" class=""> .</span></span></p></div><div class="footnote" epub:type="footnote" id="ftn.CHP-7-FN-2"><p><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">375</span><span sentence-index="5085" class="">[</span></span><a href="#CHP-7-FN-2" class="para"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">376</span><span sentence-index="5086" class="">18</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">376</span><span sentence-index="5086" class="">]  </span></span></sup><span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">5087</span><span sentence-index="5087" class="">Even  though  we&apos;re  talking  about  velocity  and  time  here,  these                techniques  apply  to  any  function&#x2014;for  example,  displacement  versus                time,  etc.</span></span></p></div></div></section>
</body></html>