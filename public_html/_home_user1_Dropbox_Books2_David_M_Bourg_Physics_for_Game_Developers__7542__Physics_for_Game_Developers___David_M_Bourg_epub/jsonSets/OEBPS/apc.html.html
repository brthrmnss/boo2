<!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><html><head><title>Appendix&#xA0;C.&#xA0;Quaternion Operations</title><link rel="stylesheet" type="text/css" href="core.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="up" href="index.html" title="Physics for Game Developers"><link rel="prev" href="apb.html" title="Appendix&#xA0;B.&#xA0;Matrix Operations"><link rel="next" href="apd.html" title="Appendix&#xA0;D.&#xA0;Bibliography"></head><body>
         
        <script>
        function ok(){ 
            window.gggs()
            return;
            //$('#musicPlayer').parent().remove();
            //speakTransportPanelDialogV2.closeEmoteDialog()
            //speakTransportPanelDialog.closeEmoteDialog()
            //
            debugger
            let url = 'http://127.0.0.1:8080/uploads/extracted/' +
             'Crazy Rich Asians  Kevin Kwanepub/' +
              'jsonSets/OEBPS/Kwan_9780385536981_epub_prl_r1.htm.html.sentences.json'
            speakTransportPanelDialogV2.sideLoadSentences2(null, null, null, url)
            
        }
        setTimeout(ok, 1500)
        </script>
        <div style="background:white">````````</div><section class="appendix" title="Appendix&#xA0;C.&#xA0;Quaternion Operations" epub:type="appendix" id="quaternion_operations-id1"><div class="titlepage"><div><div><h2 class="title"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">1</span><span sentence-index="14629" class="">Appendix&#xA0;C.&#xA0;Quaternion  Operations</span></span></h2></div></div></div><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">2</span><span sentence-index="14630" class="">This  appendix  implements  a  class  called  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">2</span><span sentence-index="14630" class="">Quaternion</span></span></code><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14630</span><span sentence-index="14630" class="">  that  encapsulates  all  of  the  operations    you  need  to  handle  quaternions  when  writing  3D  rigid-body    simulations.</span></span></p><div class="sect1" title="Quaternion Class"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="quaternion_class"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">4</span><span sentence-index="14632" class="">Quaternion  Class</span></span></h2></div></div></div><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">5</span><span sentence-index="14633" class="">The  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">5</span><span sentence-index="14633" class="">Quaternion</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">5</span><span sentence-index="14633" class=""> class  is  defined  </span></span><a id="quc.1" class="indexterm"></a><a id="I_indexterm_id368990" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">7</span><span sentence-index="14635" class="">with  a  scalar  component,  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">7</span><span sentence-index="14635" class="">n</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">7</span><span sentence-index="14635" class="">,  and  vector  component,  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">7</span><span>v</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">7</span><span sentence-index="14635" class="">,  where  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">7</span><span sentence-index="14635" class="">v</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">7</span><span sentence-index="14635" class=""> is  the  vector,  &#xD7;                </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">7</span><span sentence-index="14635" class="">i</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">7</span><span sentence-index="14635" class=""> +  y  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">7</span><span sentence-index="14635" class="">j</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">7</span><span sentence-index="14635" class=""> +  z  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">7</span><span sentence-index="14635" class="">k</span></span></strong></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14635</span><span sentence-index="14635" class=""> . </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">8</span><span sentence-index="14636" class=""> The  class  has  two  constructors,  one  of  which  initializes  the            quaternion  to  0,  and  the  other  of  which  initializes  the  elements  to  those  passed  to  the            constructor:</span></span></a></p><a id="I_programlisting_id369035"><pre class="programlisting">class Quaternion {
public:
     float      n;     // number (scalar) part
     Vector     v;     // vector part: v.x, v.y, v.z

     Quaternion(void);
     Quaternion(float e0, float e1, float e2, float e3);

     float      Magnitude(void);
     Vector     GetVector(void);
     float      GetScalar(void);
     Quaternion operator+=(Quaternion q);
     Quaternion operator-=(Quaternion q);
     Quaternion operator*=(float s);
     Quaternion operator/=(float s);
     Quaternion operator~(void) const { return Quaternion( n,
                                                           -v.x,
                                                           -v.y,
                                                           -v.z);}
};

// Constructor
inline     Quaternion::Quaternion(void)
{
     n   = 0;
     v.x = 0;
     v.y = 0;
     v.z = 0;
}

// Constructor
inline     Quaternion::Quaternion(float e0, float e1, float e2, float e3)
{
     n   = e0;
     v.x = e1;
     v.y = e2;
     v.z = e3;
}</pre></a><div class="sect2" title="Magnitude"><a id="I_programlisting_id369035"><div class="titlepage"><div><div><h3 class="title" id="magnitude-id2"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">11</span><span sentence-index="14639" class="">Magnitude</span></span></h3></div></div></div></a><p><a id="I_programlisting_id369035"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">13</span><span sentence-index="14641" class="">The  method  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">13</span><span sentence-index="14641" class="">Magnitude</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">13</span><span sentence-index="14641" class=""> returns            the  </span></span></a><a id="I_indexterm_id369068" class="indexterm"></a><a id="I_indexterm_id369080" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">15</span><span sentence-index="14643" class="">magnitude  of  the  quaternion  according  to  the  following            formula:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">15</span><span sentence-index="14643" class="">|</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">15</span><span sentence-index="14643" class="">q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">15</span><span sentence-index="14643" class="">|  =                    </span></span><span class="inlinemediaobject"><img src="inleq_ac01.png" alt=""></span>   
        </td></tr></tbody></table><p><a id="I_indexterm_id369080" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">17</span><span sentence-index="14645" class="">This  is  similar  to  calculating  the  magnitude  of  a  vector  except            that  for  quaternions  you  have  to  take  the  fourth  term,  the  scalar            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">17</span><span sentence-index="14645" class="">n</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14645</span><span sentence-index="14645" class=""> ,  into  account.</span></span></a></p><p><a id="I_indexterm_id369080" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">20</span><span sentence-index="14648" class="">Here&apos;s  the  code  that  calculates  the  magnitude  for  our  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">20</span><span sentence-index="14648" class="">Quaternion</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">20</span><span sentence-index="14648" class=""> class:</span></span></a></p><a id="I_programlisting_id369138"><pre class="programlisting">inline     float     Quaternion::Magnitude(void)
{
     return (float) sqrt(n*n + v.x*v.x + v.y*v.y + v.z*v.z);
}</pre></a></div><div class="sect2" title="GetVector"><div class="titlepage"><div><div><h3 class="title" id="getvector"><a id="I_programlisting_id369138"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">23</span><span sentence-index="14651" class="">GetVector</span></span></a></h3></div></div></div><p><a id="I_programlisting_id369138"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">25</span><span sentence-index="14653" class="">The  method  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">25</span><span sentence-index="14653" class="">GetVector</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">25</span><span sentence-index="14653" class=""> returns  </span></span></a><a id="I_indexterm_id369162" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14654</span><span sentence-index="14654" class="">the  vector  part  of  the  quaternion. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">27</span><span sentence-index="14655" class=""> This  method  uses  the  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">27</span><span sentence-index="14655" class="">Vector</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">27</span><span sentence-index="14655" class=""> class  defined  in  </span></span></a><a class="xref" href="apa.html" title="Appendix&#xA0;A.&#xA0;Vector Operations"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">28</span><span sentence-index="14656" class="">Appendix&#xA0;A</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">28</span><span sentence-index="14656" class="">:</span></span></p><a id="I_programlisting_id369186"><pre class="programlisting">inline     Vector     Quaternion::GetVector(void)
{
     return Vector(v.x, v.y, v.z);
}</pre></a></div><div class="sect2" title="GetScalar"><div class="titlepage"><div><div><h3 class="title" id="getscalar"><a id="I_programlisting_id369186"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">32</span><span sentence-index="14660" class="">GetScalar</span></span></a></h3></div></div></div><p><a id="I_programlisting_id369186"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">34</span><span sentence-index="14662" class="">The  method  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">34</span><span sentence-index="14662" class="">GetScalar</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">34</span><span sentence-index="14662" class=""> returns  the  </span></span></a><a id="I_indexterm_id369211" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">35</span><span sentence-index="14663" class="">scalar  part  of  the  quaternion:</span></span></a></p><a id="I_programlisting_id369223"><pre class="programlisting">inline     float     Quaternion::GetScalar(void)
{
     return n;
}</pre></a></div><div class="sect2" title="Quaternion Addition: The += Operator"><div class="titlepage"><div><div><h3 class="title" id="quaternion_addition_colon_the_plus_equal"><a id="I_programlisting_id369223"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">39</span><span sentence-index="14667" class="">Quaternion  Addition:  The  +=  Operator</span></span></a></h3></div></div></div><p><a id="I_programlisting_id369223"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">41</span><span sentence-index="14669" class="">This  operator  </span></span></a><a id="I_indexterm_id369244" class="indexterm"></a><a id="I_indexterm_id369254" class="indexterm"></a><a id="I_indexterm_id369264" class="indexterm"></a><a id="I_indexterm_id369270" class="indexterm"></a><a id="I_indexterm_id369280" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">46</span><span sentence-index="14674" class="">performs  quaternion  addition  by  simply  adding  the            quaternion,  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">46</span><span sentence-index="14674" class="">q</span></span></strong></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14674</span><span sentence-index="14674" class=""> ,  to  the  current            quaternion  on  a  component-by-component  basis.</span></span></a></p><p><a id="I_indexterm_id369280" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class="">If  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class=""> and  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span>p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class=""> are  two  quaternions,  then:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class=""> +  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span>p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class=""> =  [n</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class=""> +                n</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class="">,  (x</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class=""> +                x</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span>)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class="">i</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class=""> +                (y</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class=""> +  y</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span>)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class="">j</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class=""> +  (z</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class="">q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class=""> +                z</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class="">p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class="">)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class="">k</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">49</span><span sentence-index="14677" class="">]</span></span></td></tr></tbody></table><p><a id="I_indexterm_id369280" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class="">Here,  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span>n</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span> +            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class="">n</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class=""> is  the  scalar  part  of  the            resulting  quaternion,  while            (</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span>x</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span> +            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class="">x</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span>)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class="">i</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span> +            (</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span>y</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span> +            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class="">y</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span>)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class="">j</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class=""> +            (</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span>z</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class="">q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class=""> +            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class="">z</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class="">p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class="">)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">51</span><span sentence-index="14679" class="">k</span></span></strong></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14679</span><span sentence-index="14679" class="">  is  the  vector  part.</span></span></a></p><p><a id="I_indexterm_id369280" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span sentence-index="14682" class="">Quaternion  addition  is  both  associative  and  commutative;            thus:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span sentence-index="14682" class=""> +  (</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span>p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span> +  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span>h</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span sentence-index="14682" class="">)  =                (</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span> +  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span>p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span sentence-index="14682" class="">)  +  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span sentence-index="14682" class="">h</span></span></strong></span></td></tr><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span sentence-index="14682" class=""> +  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span>p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span sentence-index="14682" class=""> =  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span sentence-index="14682" class="">p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span sentence-index="14682" class=""> +                </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">54</span><span sentence-index="14682" class="">q</span></span></strong></span></td></tr></tbody></table><p><a id="I_indexterm_id369280" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">56</span><span sentence-index="14684" class="">Here&apos;s  the  code  that  adds  the  quaternion  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">56</span><span sentence-index="14684" class="">q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">56</span><span sentence-index="14684" class=""> to  our  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">56</span><span sentence-index="14684" class="">Quaternion</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">56</span><span sentence-index="14684" class=""> class:</span></span></a></p><a id="I_programlisting_id369544"><pre class="programlisting">inline     Quaternion     Quaternion::operator+=(Quaternion q)
{
     n += q.n;
     v.x += q.v.x;
     v.y += q.v.y;
     v.z += q.v.z;
     return *this;
}</pre></a></div><div class="sect2" title="Quaternion Subtraction: The &#x2212;= Operator"><div class="titlepage"><div><div><h3 class="title" id="quaternion_subtraction_colon_the_m_equal"><a id="I_programlisting_id369544"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">59</span><span sentence-index="14687" class="">Quaternion  Subtraction:  The  &#x2212;=  Operator</span></span></a></h3></div></div></div><p><a id="I_programlisting_id369544"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">61</span><span sentence-index="14689" class="">This  operator  performs  </span></span></a><a id="I_indexterm_id369565" class="indexterm"></a><a id="I_indexterm_id369575" class="indexterm"></a><a id="I_indexterm_id369584" class="indexterm"></a><a id="I_indexterm_id369590" class="indexterm"></a><a id="I_indexterm_id369599" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">66</span><span sentence-index="14694" class="">quaternion  subtraction  by  simply  subtracting  the            quaternion,  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">66</span><span sentence-index="14694" class="">q</span></span></strong></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14694</span><span sentence-index="14694" class=""> ,  from  the  current            quaternion  on  a  component-by-component  basis.</span></span></a></p><p><a id="I_indexterm_id369599" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class="">If  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class=""> and  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class=""> are  two  quaternions,  then:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class=""> &#x2212;  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class=""> =  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class=""> +                (&#x2212;</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class="">)  =  [n</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class=""> &#x2212;                n</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class="">,  (x</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class=""> &#x2212;                x</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class="">i</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class=""> +                (y</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class=""> &#x2212;  y</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span>)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class="">j</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class=""> +  (z</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class="">q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class=""> &#x2212;                z</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class="">p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class="">)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class="">k</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">69</span><span sentence-index="14697" class="">]</span></span></td></tr></tbody></table><p><a id="I_indexterm_id369599" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class="">Here,  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span>n</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span> &#x2212;            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class="">n</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class=""> is  the  scalar  part  of  the            resulting  quaternion,  while            (</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span>x</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span> &#x2212;            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class="">x</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span>)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class="">i</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span> +            (</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span>y</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span> &#x2212;            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class="">y</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span>)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class="">j</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class=""> +            (</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span>z</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class="">q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class=""> &#x2212;            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class="">z</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class="">p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class="">)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">71</span><span sentence-index="14699" class="">k</span></span></strong></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14699</span><span sentence-index="14699" class="">  is  the  vector  part.</span></span></a></p><p><a id="I_indexterm_id369599" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">74</span><span sentence-index="14702" class="">Here&apos;s  the  code  that  subtracts  the  quaternion  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">74</span><span sentence-index="14702" class="">q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">74</span><span sentence-index="14702" class=""> from  our  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">74</span><span sentence-index="14702" class="">Quaternion</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">74</span><span sentence-index="14702" class=""> class:</span></span></a></p><a id="I_programlisting_id369801"><pre class="programlisting">inline     Quaternion     Quaternion::operator-=(Quaternion q)
{
     n -= q.n;
     v.x -= q.v.x;
     v.y -= q.v.y;
     v.z -= q.v.z;
     return *this;
}</pre></a></div><div class="sect2" title="Scalar Multiplication: The *= Operator"><div class="titlepage"><div><div><h3 class="title" id="scalar_multiplication_colon_the-id4"><a id="I_programlisting_id369801"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">77</span><span sentence-index="14705" class="">Scalar  Multiplication:  The  *=  Operator</span></span></a></h3></div></div></div><p><a id="I_programlisting_id369801"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">79</span><span sentence-index="14707" class="">This  operator  simply  multiplies  </span></span></a><a id="I_indexterm_id369821" class="indexterm"></a><a id="I_indexterm_id369831" class="indexterm"></a><a id="I_indexterm_id369841" class="indexterm"></a><a id="I_indexterm_id369851" class="indexterm"></a><a id="I_indexterm_id369861" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">84</span><span sentence-index="14712" class="">each  component  in  the  quaternion  by  the  scalar  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">84</span><span sentence-index="14712" class="">s</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14712</span><span sentence-index="14712" class=""> . </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">85</span><span sentence-index="14713" class=""> This                operation  is  similar  to  scaling  a  vector,  as  described  in  </span></span></a><a class="xref" href="apa.html" title="Appendix&#xA0;A.&#xA0;Vector Operations"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">86</span><span sentence-index="14714" class="">Appendix&#xA0;A</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">86</span><span sentence-index="14714" class="">:</span></span></p><a id="I_programlisting_id369881"><pre class="programlisting">inline     Quaternion Quaternion::operator*=(float s)
{
     n *= s;
     v.x *= s;
     v.y *= s;
     v.z *= s;
     return *this;
}</pre></a></div><div class="sect2" title="Scalar Division: The /= Operator"><div class="titlepage"><div><div><h3 class="title" id="scalar_division_colon_the_solidus"><a id="I_programlisting_id369881"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">90</span><span sentence-index="14718" class="">Scalar  Division:  The  /=  Operator</span></span></a></h3></div></div></div><p><a id="I_programlisting_id369881"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">92</span><span sentence-index="14720" class="">This  operator  simply  </span></span></a><a id="I_indexterm_id369900" class="indexterm"></a><a id="I_indexterm_id369912" class="indexterm"></a><a id="I_indexterm_id369922" class="indexterm"></a><a id="I_indexterm_id369932" class="indexterm"></a><a id="I_indexterm_id369941" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">97</span><span sentence-index="14725" class="">divides  each  component  in  the  quaternion  by  the  scalar                </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">97</span><span sentence-index="14725" class="">s</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">97</span><span sentence-index="14725" class="">:</span></span></a></p><a id="I_programlisting_id369958"><pre class="programlisting">inline     Quaternion Quaternion::operator/=(float s)
{
     n /= s;
     v.x /= s;
     v.y /= s;
     v.z /= s;
     return *this;
}</pre></a></div><div class="sect2" title="Conjugate: The ~ Operator"><div class="titlepage"><div><div><h3 class="title" id="conjugate_colon_the_tilde_operato"><a id="I_programlisting_id369958"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">100</span><span sentence-index="14728" class="">Conjugate:  The  ~  Operator</span></span></a></h3></div></div></div><p><a id="I_programlisting_id369958"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">102</span><span sentence-index="14730" class="">This  operator  takes  the</span></span></a><a id="I_indexterm_id369979" class="indexterm"></a><a id="I_indexterm_id369989" class="indexterm"></a><a id="I_indexterm_id369998" class="indexterm"></a><a id="I_indexterm_id370008" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">106</span><span sentence-index="14734" class=""> conjugate  of  the  quaternion,  ~</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">106</span><span sentence-index="14734" class="">q</span></span></strong></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14734</span><span sentence-index="14734" class=""> ,  which  is  simply  the  negative  of  the  vector            part. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class=""> If  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span> =  [</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span>n</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class="">,            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span>x</span></span></em></span> <span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span>i</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span> +            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span>y</span></span></em></span> <span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span>j</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class=""> +            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span>z</span></span></em></span> <span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span>k</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class="">],  then            ~</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class="">q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class=""> =  [</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class="">n</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class="">,            (&#x2212;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class="">x</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span>)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class="">i</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span> +            (&#x2212;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class="">y</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span>)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class="">j</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class=""> +            (&#x2212;</span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class="">z</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class="">)  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">107</span><span sentence-index="14735" class="">k</span></span></strong></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14735</span><span sentence-index="14735" class=""> ].</span></span></a></p><p><a id="I_indexterm_id370008" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">110</span><span sentence-index="14738" class="">The  conjugate  of  the  product  of  quaternions  is  equal  to  the            product  of  the  quaternion  conjugates,  but  in  </span></span></a><a id="I_indexterm_id370106" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="14739" class="">reverse  order:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="14739" class="">~(</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="14739" class="">qp</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="14739" class="">)  =  (~</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="14739" class="">p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="14739" class="">)(~</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="14739" class="">q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">111</span><span sentence-index="14739" class="">)</span></span></td></tr></tbody></table><p><a id="I_indexterm_id370106" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">114</span><span sentence-index="14742" class="">Here&apos;s  the  code  that  computes  the  conjugate  for  our  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">114</span><span sentence-index="14742" class="">Quaternion</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">114</span><span sentence-index="14742" class=""> class:</span></span></a></p><a id="I_programlisting_id370155"><pre class="programlisting">     Quaternion operator~(void) const { return Quaternion( n,
                                                           -v.x,
                                                           -v.y,
                                                           -v.z);}</pre></a></div></div><div class="sect1" title="Quaternion Functions and Operators"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="quaternion_functions_and_operators"><a id="I_programlisting_id370155"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">117</span><span sentence-index="14745" class="">Quaternion  Functions  and  Operators</span></span></a></h2></div></div></div><p><a id="I_programlisting_id370155"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">119</span><span sentence-index="14747" class="">The  functions  and  overloaded  </span></span></a><a id="quc.2" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14748</span><span sentence-index="14748" class="">operators  that  follow  are  useful  when  you  are  performing        operations  with  two  quaternions,  or  with  a  quaternion  and  a  scalar,  or  a        quaternion  and  a  vector. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">121</span><span sentence-index="14749" class=""> Here,  the  quaternions  are  assumed  to  be  of  the        type  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">121</span><span sentence-index="14749" class="">Quaternion</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">121</span><span sentence-index="14749" class="">,  and  vectors  of  the        type  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">121</span><span sentence-index="14749" class="">Vector</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">121</span><span sentence-index="14749" class="">,  as  discussed  in  </span></span></a><a class="xref" href="apa.html" title="Appendix&#xA0;A.&#xA0;Vector Operations"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">122</span><span sentence-index="14750" class="">Appendix&#xA0;A</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14751</span><span sentence-index="14751" class=""> .</span></span></p><div class="sect2" title="Quaternion Addition: The + Operator"><div class="titlepage"><div><div><h3 class="title" id="quaternion_addition_colon_the_plus_opera"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">125</span><span sentence-index="14753" class="">Quaternion  Addition:  The  +  Operator</span></span></h3></div></div></div><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">126</span><span sentence-index="14754" class="">This  operator  </span></span><a id="I_indexterm_id370223" class="indexterm"></a><a id="I_indexterm_id370233" class="indexterm"></a><a id="I_indexterm_id370243" class="indexterm"></a><a id="I_indexterm_id370249" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">130</span><span sentence-index="14758" class="">performs  quaternion  addition  by  simply  adding  the  quaternion  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">130</span><span sentence-index="14758" class="">q1</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">130</span><span sentence-index="14758" class=""> to  quaternion  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">130</span><span sentence-index="14758" class="">q2</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">130</span><span sentence-index="14758" class=""> on  a                component-by-component  basis:</span></span></a></p><a id="I_programlisting_id370274"><pre class="programlisting">inline     Quaternion operator+(Quaternion q1, Quaternion q2)
{
     return     Quaternion(     q1.n + q2.n,
                                   q1.v.x + q2.v.x,
                                   q1.v.y + q2.v.y,
                                   q1.v.z + q2.v.z);
}</pre></a></div><div class="sect2" title="Quaternion Subtraction: The &#x2212; Operator"><div class="titlepage"><div><div><h3 class="title" id="quaternion_subtraction_colon_the_m_opera"><a id="I_programlisting_id370274"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">133</span><span sentence-index="14761" class="">Quaternion  Subtraction:  The  &#x2212;  Operator</span></span></a></h3></div></div></div><p><a id="I_programlisting_id370274"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">135</span><span sentence-index="14763" class="">This  operator  performs  </span></span></a><a id="I_indexterm_id370295" class="indexterm"></a><a id="I_indexterm_id370305" class="indexterm"></a><a id="I_indexterm_id370315" class="indexterm"></a><a id="I_indexterm_id370321" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">139</span><span sentence-index="14767" class="">quaternion  subtraction  by  simply  subtracting  the  quaternion  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">139</span><span sentence-index="14767" class="">q2</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">139</span><span sentence-index="14767" class=""> from  quaternion  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">139</span><span sentence-index="14767" class="">q1</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">139</span><span sentence-index="14767" class=""> on  a                component-by-component  basis:</span></span></a></p><a id="I_programlisting_id370346"><pre class="programlisting">inline     Quaternion operator-(Quaternion q1, Quaternion q2)
{
     return     Quaternion(     q1.n - q2.n,
                                   q1.v.x - q2.v.x,
                                   q1.v.y - q2.v.y,
                                   q1.v.z - q2.v.z);
}</pre></a></div><div class="sect2" title="Quaternion Multiplication: The * Operator"><div class="titlepage"><div><div><h3 class="title" id="quaternion_multiplication_colon_the"><a id="I_programlisting_id370346"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">142</span><span sentence-index="14770" class="">Quaternion  Multiplication:  The  *  Operator</span></span></a></h3></div></div></div><p><a id="I_programlisting_id370346"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">144</span><span sentence-index="14772" class="">This  operator  performs  </span></span></a><a id="I_indexterm_id370369" class="indexterm"></a><a id="I_indexterm_id370379" class="indexterm"></a><a id="I_indexterm_id370389" class="indexterm"></a><a id="I_indexterm_id370396" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="14776" class="">quaternion  multiplication  according  to  the  following            formula:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="14776" class="">q  p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="14776" class=""> =                n</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="14776" class=""> n</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="14776" class=""> &#x2212;  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span>v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="14776" class=""> &#x2022;  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span>v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span> +                n</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span>q</span></span></sub> <span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span>v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="14776" class=""> +                n</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span>p</span></span></sub> <span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span>v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="14776" class=""> +  (</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span>v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="14776" class="">q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="14776" class=""> &#xD7;  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="14776" class="">v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="14776" class="">p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">148</span><span sentence-index="14776" class="">)</span></span></td></tr></tbody></table><p><a id="I_indexterm_id370396" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span sentence-index="14778" class="">Here,            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>n</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>q</span></span></sub><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>n</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span sentence-index="14778" class="">           &#x2212;  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span sentence-index="14778" class=""> &#x2022;            </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span sentence-index="14778" class=""> is  the            scalar  part  of  the  result,  while            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>n</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>q</span></span></sub> <span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span sentence-index="14778" class=""> +            </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span sentence-index="14778" class="">n</span></span></em></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>p</span></span></sub> <span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span sentence-index="14778" class=""> +  (</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span>v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span sentence-index="14778" class="">q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span sentence-index="14778" class=""> &#xD7;  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span sentence-index="14778" class="">v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">150</span><span sentence-index="14778" class="">p</span></span></sub><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14778</span><span sentence-index="14778" class=""> )  is  the  vector  part. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">151</span><span sentence-index="14779" class="">           Also  note  that  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">151</span><span>v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">151</span><span>q</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">151</span><span> and  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">151</span><span sentence-index="14779" class="">v</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">151</span><span>p</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">151</span><span sentence-index="14779" class=""> are  the  vector  parts            of  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">151</span><span sentence-index="14779" class="">q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">151</span><span sentence-index="14779" class=""> and  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">151</span><span sentence-index="14779" class="">p</span></span></strong></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14779</span><span sentence-index="14779" class=""> ,  respectively,  &#x2022;  is  the  vector  dot-product            operator,  and  &#xD7;  is  the  vector  cross-product  operator.</span></span></a></p><p><a id="I_indexterm_id370396" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">154</span><span sentence-index="14782" class="">Quaternion  multiplication  is  associative  but  not  commutative;            thus:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">154</span><span sentence-index="14782" class="">q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">154</span><span sentence-index="14782" class="">(</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">154</span><span sentence-index="14782" class="">ph</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">154</span><span sentence-index="14782" class="">)  =  (</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">154</span><span>qp</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">154</span><span sentence-index="14782" class="">)</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">154</span><span sentence-index="14782" class="">h</span></span></strong></span></td></tr><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">154</span><span sentence-index="14782" class="">qp</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">154</span><span sentence-index="14782" class=""> &#x2260;  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">154</span><span sentence-index="14782" class="">pq</span></span></strong></span></td></tr></tbody></table><p><a id="I_indexterm_id370396" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">156</span><span sentence-index="14784" class="">Here&apos;s  the  code  that  multiplies  two  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">156</span><span sentence-index="14784" class="">Quaternion</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">156</span><span sentence-index="14784" class="">s,  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">156</span><span sentence-index="14784" class="">q1</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">156</span><span sentence-index="14784" class=""> and  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">156</span><span sentence-index="14784" class="">q2</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">156</span><span sentence-index="14784" class="">:</span></span></a></p><a id="I_programlisting_id370665"><pre class="programlisting">inline     Quaternion operator*(Quaternion q1, Quaternion q2)
{
     return     Quaternion(q1.n*q2.n - q1.v.x*q2.v.x
                               - q1.v.y*q2.v.y - q1.v.z*q2.v.z,
                           q1.n*q2.v.x + q1.v.x*q2.n
                               + q1.v.y*q2.v.z - q1.v.z*q2.v.y,
                           q1.n*q2.v.y + q1.v.y*q2.n
                               + q1.v.z*q2.v.x - q1.v.x*q2.v.z,
                           q1.n*q2.v.z + q1.v.z*q2.n
                               + q1.v.x*q2.v.y - q1.v.y*q2.v.x);
}</pre></a></div><div class="sect2" title="Scalar Multiplication: The * Operator"><div class="titlepage"><div><div><h3 class="title" id="scalar_multiplication_colon_the-id5"><a id="I_programlisting_id370665"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">159</span><span sentence-index="14787" class="">Scalar  Multiplication:  The  *  Operator</span></span></a></h3></div></div></div><p><a id="I_programlisting_id370665"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">161</span><span sentence-index="14789" class="">This  operator  simply  multiplies</span></span></a><a id="I_indexterm_id370687" class="indexterm"></a><a id="I_indexterm_id370698" class="indexterm"></a><a id="I_indexterm_id370708" class="indexterm"></a><a id="I_indexterm_id370718" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">165</span><span sentence-index="14793" class=""> each  component  in  the  quaternion  by  the  scalar  </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">165</span><span sentence-index="14793" class="">s</span></span></em></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14793</span><span sentence-index="14793" class=""> . </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">166</span><span sentence-index="14794" class=""> There                are  two  forms  of  this  operator,  depending  on  the  order  in  which  the  quaternion  and  scalar                are  encountered:</span></span></a></p><a id="I_programlisting_id370735"><pre class="programlisting">inline     Quaternion operator*(Quaternion q, float s)
{
     return     Quaternion(q.n*s, q.v.x*s, q.v.y*s, q.v.z*s);
}

inline     Quaternion operator*(float s, Quaternion q)
{
     return     Quaternion(q.n*s, q.v.x*s, q.v.y*s, q.v.z*s);
}</pre></a></div><div class="sect2" title="Vector Multiplication: The * Operator"><div class="titlepage"><div><div><h3 class="title" id="vector_multiplication_colon_the_aste-id2"><a id="I_programlisting_id370735"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">169</span><span sentence-index="14797" class="">Vector  Multiplication:  The  *  Operator</span></span></a></h3></div></div></div><p><a id="I_programlisting_id370735"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">171</span><span sentence-index="14799" class="">This  operator  multiplies  the  </span></span></a><a id="I_indexterm_id370758" class="indexterm"></a><a id="I_indexterm_id370768" class="indexterm"></a><a id="I_indexterm_id370778" class="indexterm"></a><a id="I_indexterm_id370788" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">175</span><span sentence-index="14803" class="">quaternion  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">175</span><span sentence-index="14803" class="">q</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">175</span><span sentence-index="14803" class=""> by  the  vector  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">175</span><span>v</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">175</span><span sentence-index="14803" class=""> as  though  the  vector  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">175</span><span sentence-index="14803" class="">v</span></span></code><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14803</span><span sentence-index="14803" class="">  were                a  quaternion  with  its  scalar  component  equal  to  0. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14804</span><span sentence-index="14804" class="">  There  are  two  forms  of  this  operator,                depending  on  the  order  in  which  the  quaternion  and  vector  are  encountered. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">177</span><span sentence-index="14805" class=""> Since  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">177</span><span sentence-index="14805" class="">v</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">177</span><span sentence-index="14805" class=""> is  assumed  to  be  a  quaternion  with  its  scalar  part  equal  to  0,                the  rules  of  multiplication  follow  those  outlined  earlier  for  quaternion                multiplication:</span></span></a></p><a id="I_programlisting_id370826"><pre class="programlisting">inline     Quaternion operator*(Quaternion q, Vector v)
{
     return     Quaternion(     -(q.v.x*v.x + q.v.y*v.y + q.v.z*v.z),
                                   q.n*v.x + q.v.y*v.z - q.v.z*v.y,
                                   q.n*v.y + q.v.z*v.x - q.v.x*v.z,
                                   q.n*v.z + q.v.x*v.y - q.v.y*v.x);
}
inline     Quaternion operator*(Vector v, Quaternion q)
{
     return     Quaternion(     -(q.v.x*v.x + q.v.y*v.y + q.v.z*v.z),
                                   q.n*v.x + q.v.z*v.y - q.v.y*v.z,
                                   q.n*v.y + q.v.x*v.z - q.v.z*v.x,
                                   q.n*v.z + q.v.y*v.x - q.v.x*v.y);
}</pre></a></div><div class="sect2" title="Scalar Division: The / Operator"><div class="titlepage"><div><div><h3 class="title" id="scalar_division_colon_the_solidus_op"><a id="I_programlisting_id370826"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">180</span><span sentence-index="14808" class="">Scalar  Division:  The  /  Operator</span></span></a></h3></div></div></div><p><a id="I_programlisting_id370826"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">182</span><span sentence-index="14810" class="">This  operator  </span></span></a><a id="I_indexterm_id370850" class="indexterm"></a><a id="I_indexterm_id370860" class="indexterm"></a><a id="I_indexterm_id370871" class="indexterm"></a><a id="I_indexterm_id370881" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">186</span><span sentence-index="14814" class="">simply  divides  each  component  in  the  quaternion  by  the  scalar                    </span></span><span class="emphasis"><em><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">186</span><span sentence-index="14814" class="">s</span></span></em></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">186</span><span sentence-index="14814" class="">:</span></span></a></p><a id="I_programlisting_id370896"><pre class="programlisting">inline     Quaternion operator/(Quaternion q, float s)
{
     return     Quaternion(q.n/s, q.v.x/s, q.v.y/s, q.v.z/s);
}</pre></a></div><div class="sect2" title="QGetAngle"><div class="titlepage"><div><div><h3 class="title" id="qgetangle"><a id="I_programlisting_id370896"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">189</span><span sentence-index="14817" class="">QGetAngle</span></span></a></h3></div></div></div><p><a id="I_programlisting_id370896"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">191</span><span sentence-index="14819" class="">This  function</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">191</span><span sentence-index="14819" class="">[</span></span></sup></a><a id="APP-C-FN-1" href="#ftn.APP-C-FN-1" epub:type="noteref" class="footnote"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">192</span><span sentence-index="14820" class="">30</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">192</span><span sentence-index="14820" class="">]  extracts  the  </span></span><a id="I_indexterm_id370936" class="indexterm"></a><a id="I_indexterm_id370946" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">195</span><span sentence-index="14823" class="">angle  of  rotation  about  the  axis  represented  by  the  vector  part  of  the                quaternion:</span></span></a></p><a id="I_programlisting_id370955"><pre class="programlisting">inline     float QGetAngle(Quaternion q)
{
     return     (float) (2*acos(q.n));
}</pre></a></div><div class="sect2" title="QGetAxis"><div class="titlepage"><div><div><h3 class="title" id="qgetaxis"><a id="I_programlisting_id370955"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">198</span><span sentence-index="14826" class="">QGetAxis</span></span></a></h3></div></div></div><p><a id="I_programlisting_id370955"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">200</span><span sentence-index="14828" class="">This  function  </span></span></a><a id="I_indexterm_id370973" class="indexterm"></a><a id="I_indexterm_id370984" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">202</span><span sentence-index="14830" class="">returns  a  unit  vector  along  the  axis  of  rotation  represented  by  the  vector  part                of  the  quaternion  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">202</span><span sentence-index="14830" class="">q</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">202</span><span sentence-index="14830" class="">:</span></span></a></p><a id="I_programlisting_id370999"><pre class="programlisting">inline     Vector QGetAxis(Quaternion q)
{
     Vector v;
     float m;

     v = q.GetVector();
     m = v.Magnitude();

     if (m &lt;= tol)
          return Vector();
     else
          return v/m;
}</pre></a></div><div class="sect2" title="QRotate"><div class="titlepage"><div><div><h3 class="title" id="qrotate"><a id="I_programlisting_id370999"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">205</span><span sentence-index="14833" class="">QRotate</span></span></a></h3></div></div></div><p><a id="I_programlisting_id370999"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">207</span><span sentence-index="14835" class="">This  function  </span></span></a><a id="I_indexterm_id371020" class="indexterm"></a><a id="I_indexterm_id371030" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">209</span><span sentence-index="14837" class="">rotates  the  quaternion  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">209</span><span>p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">209</span><span sentence-index="14837" class=""> by  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">209</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">209</span><span sentence-index="14837" class="">           according  to  the  formula:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">209</span><span>p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">209</span><span sentence-index="14837" class="">&apos;  =  (</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">209</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">209</span><span sentence-index="14837" class="">)(</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">209</span><span sentence-index="14837" class="">p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">209</span><span sentence-index="14837" class="">)(~</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">209</span><span sentence-index="14837" class="">q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">209</span><span sentence-index="14837" class="">)</span></span></td></tr></tbody></table><p><a id="I_indexterm_id371030" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">211</span><span sentence-index="14839" class="">Here,  ~</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">211</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">211</span><span sentence-index="14839" class=""> is  the  conjugate  of            the  unit  quaternion  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">211</span><span sentence-index="14839" class="">q</span></span></strong></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14839</span><span sentence-index="14839" class=""> . </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">212</span><span sentence-index="14840" class=""> Here&apos;s  the            code:</span></span></a></p><a id="I_programlisting_id371100"><pre class="programlisting">inline     Quaternion QRotate(Quaternion q1, Quaternion q2)
{
     return     q1*q2*(~q1);
}</pre></a></div><div class="sect2" title="QVRotate"><div class="titlepage"><div><div><h3 class="title" id="qvrotate-id1"><a id="I_programlisting_id371100"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">215</span><span sentence-index="14843" class="">QVRotate</span></span></a></h3></div></div></div><p><a id="I_programlisting_id371100"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">217</span><span sentence-index="14845" class="">This  function  </span></span></a><a id="I_indexterm_id371119" class="indexterm"></a><a id="I_indexterm_id371129" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">219</span><span sentence-index="14847" class="">rotates  the  vector  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">219</span><span>v</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">219</span><span sentence-index="14847" class=""> by            the  unit  quaternion  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">219</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">219</span><span sentence-index="14847" class=""> according  to            the  formula:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">219</span><span sentence-index="14847" class="">p</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">219</span><span sentence-index="14847" class="">&apos;  =  (</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">219</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">219</span><span sentence-index="14847" class="">)(</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">219</span><span sentence-index="14847" class="">v</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">219</span><span sentence-index="14847" class="">)(~</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">219</span><span sentence-index="14847" class="">q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">219</span><span sentence-index="14847" class="">)</span></span></td></tr></tbody></table><p><a id="I_indexterm_id371129" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">221</span><span sentence-index="14849" class="">Here,  ~</span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">221</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">221</span><span sentence-index="14849" class=""> is  the  conjugate  of            the  unit  quaternion  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">221</span><span sentence-index="14849" class="">q</span></span></strong></span><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14849</span><span sentence-index="14849" class=""> . </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">222</span><span sentence-index="14850" class=""> Here&apos;s  the            code:</span></span></a></p><a id="I_programlisting_id371198"><pre class="programlisting">inline     Vector     QVRotate(Quaternion q, Vector v)
{
     Quaternion t;


     t = q*v*(~q);

     return     t.GetVector();
}</pre></a></div><div class="sect2" title="MakeQFromEulerAngles"><div class="titlepage"><div><div><h3 class="title" id="makeqfromeulerangles-id1"><a id="I_programlisting_id371198"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">225</span><span sentence-index="14853" class="">MakeQFromEulerAngles</span></span></a></h3></div></div></div><p><a id="I_programlisting_id371198"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">227</span><span sentence-index="14855" class="">This  function  </span></span></a><a id="I_indexterm_id371219" class="indexterm"></a><a id="I_indexterm_id371229" class="indexterm"></a><a id="I_indexterm_id371236" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14858</span><span sentence-index="14858" class="">constructs  a  quaternion  from  a  set  of  Euler  angles.</span></span></a></p><p><a id="I_indexterm_id371236" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14861</span><span sentence-index="14861" class="">For  a  given  set  of  Euler  angles,  yaw  (&#x3C8;),  pitch  (&#x3C4;),  and  roll  (&#x3C6;),            defining  rotation  about  the  z-axis,  then  the  y-axis,  and  then  the            z-axis,  you  can  construct  the  representative  rotation  quaternion. </span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14862</span><span sentence-index="14862" class="">  You  do            this  by  first  constructing  a  quaternion  for  each  Euler  angle  and  then            multiplying  the  three  quaternions  following  the  rules  of  quaternion            multiplication. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class=""> Here  are  the  three  quaternions  representing  each  Euler            rotation  angle:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span>q</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class="">roll</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class=""> =  [cos(&#x3C6;/2),                (sin(&#x3C6;/2))  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span>i</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span> +  0  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span>j</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span> +  0  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span>k</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span>]</span></span></td></tr><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span>q</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class="">pitch</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class=""> =  [cos(&#x3C4;  /2),  0                </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span>i</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class=""> +  (sin(&#x3C4;  /2))  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span>j</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span> +  0  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span>k</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span>]</span></span></td></tr><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class="">q</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class="">yaw</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class="">               =  [cos(&#x3C8;  /2),  0  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class="">i</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class=""> +  0  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class="">j</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class=""> +  (sin(&#x3C8;  /2))  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class="">k</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">235</span><span sentence-index="14863" class="">]</span></span></td></tr></tbody></table><p><a id="I_indexterm_id371236" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14865</span><span sentence-index="14865" class="">Each  one  of  these  quaternions  is  of  unit  length.</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">238</span><span sentence-index="14866" class="">[</span></span></sup></a><a id="APP-C-FN-2" href="#ftn.APP-C-FN-2" epub:type="noteref" class="footnote"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">239</span><span sentence-index="14867" class="">31</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">239</span><span sentence-index="14867" class="">]</span></span></p><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span sentence-index="14869" class="">Now  you  can  multiply  these  quaternions  to  obtain  a  single  one  that            represents  the  rotation,  or  orientation,  defined  by  the  three  Euler            angles:</span></span></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span sentence-index="14869" class=""> =  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span>q</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span sentence-index="14869" class="">yaw</span></span></sub> <span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span>q</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span sentence-index="14869" class="">pitch</span></span></sub> <span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span sentence-index="14869" class="">q</span></span></strong></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">241</span><span sentence-index="14869" class="">roll</span></span></sub></td></tr></tbody></table><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">242</span><span sentence-index="14870" class="">Performing  this  multiplication  yields:</span></span></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">242</span><span sentence-index="14870" class="">q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">242</span><span sentence-index="14870" class=""> =  [  {cos(&#x3C6;/2)  cos(&#x3C4;  /2)                cos(&#x3C8;  /2)  +  sin(&#x3C6;/2)  sin(&#x3C4;  /2)  sin(&#x3C8;  /2)},</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">242</span><span sentence-index="14870" class="">{  sin(&#x3C6;/2)  cos(&#x3C4;  /2)  cos(&#x3C8;  /2)  -  cos(&#x3C6;/2)  sin(&#x3C4;  /2)  sin(&#x3C8;  /2)                }  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">242</span><span sentence-index="14870" class="">i</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">242</span><span> +</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">242</span><span sentence-index="14870" class="">{  cos(&#x3C6;/2)  sin(&#x3C4;  /2)  cos(&#x3C8;  /2)  +  sin(&#x3C6;/2)  cos(&#x3C4;  /2)  sin(&#x3C8;  /2)                }  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">242</span><span sentence-index="14870" class="">j</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">242</span><span sentence-index="14870" class=""> +</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">242</span><span sentence-index="14870" class="">{  cos(&#x3C6;/2)  cos(&#x3C4;  /2)  sin(&#x3C8;  /2)  -  sin(&#x3C6;/2)  sin(&#x3C4;  /2)  cos(&#x3C8;  /2)                }  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">242</span><span sentence-index="14870" class="">k</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">242</span><span sentence-index="14870" class=""> ]</span></span></td></tr></tbody></table><p><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">243</span><span sentence-index="14871" class="">Here&apos;s  the  code  that  takes  three  Euler  angles  and  returns  a            quaternion:</span></span></p><a id="I_programlisting_id371469"><pre class="programlisting">inline     Quaternion     MakeQFromEulerAngles(float x, float y, float z)
{
     Quaternion     q;
     double     roll = DegreesToRadians(x);
     double     pitch = DegreesToRadians(y);
     double     yaw = DegreesToRadians(z);

     double     cyaw, cpitch, croll, syaw, spitch, sroll;
     double     cyawcpitch, syawspitch, cyawspitch, syawcpitch;

     cyaw = cos(0.5f * yaw);
     cpitch = cos(0.5f * pitch);
     croll = cos(0.5f * roll);
     syaw = sin(0.5f * yaw);
     spitch = sin(0.5f * pitch);
     sroll = sin(0.5f * roll);

     cyawcpitch = cyaw*cpitch;
     syawspitch = syaw*spitch;
     cyawspitch = cyaw*spitch;
     syawcpitch = syaw*cpitch;

     q.n = (float) (cyawcpitch * croll + syawspitch * sroll);
     q.v.x = (float) (cyawcpitch * sroll - syawspitch * croll);
     q.v.y = (float) (cyawspitch * croll + syawcpitch * sroll);
     q.v.z = (float) (syawcpitch * croll - cyawspitch * sroll);

     return q;
}</pre></a></div><div class="sect2" title="MakeEulerAnglesFromQ"><div class="titlepage"><div><div><h3 class="title" id="makeeuleranglesfromq-id1"><a id="I_programlisting_id371469"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">246</span><span sentence-index="14874" class="">MakeEulerAnglesFromQ</span></span></a></h3></div></div></div><p><a id="I_programlisting_id371469"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">248</span><span sentence-index="14876" class="">This  function  </span></span></a><a id="I_indexterm_id371495" class="indexterm"></a><a id="I_indexterm_id371506" class="indexterm"></a><a id="I_indexterm_id371512" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14879</span><span sentence-index="14879" class="">extracts  the  three  Euler  angles  from  a  given            quaternion.</span></span></a></p><p><a id="I_indexterm_id371512" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14882</span><span sentence-index="14882" class="">You  can  extract  the  three  Euler  angles  from  a  quaternion  by  first            converting  the  quaternion  to  a  rotation  matrix  and  then  extracting  the            Euler  angles  from  the  rotation  matrix. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">255</span><span sentence-index="14883" class=""> Let  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">255</span><span sentence-index="14883" class="">R</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">255</span><span sentence-index="14883" class=""> be  a  nine-element  rotation  matrix:</span></span></a></p><div class="informalfigure"><a id="appendixcmatrix1"></a><div class="mediaobject"><a id="appendixcmatrix1"></a><a id="I_mediaobject_id371543"><img src="httpatomoreillycomsourceoreillyimages1599042.png" alt="image with no caption"></a></div></div><p><a id="I_mediaobject_id371543"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">260</span><span sentence-index="14888" class="">and  let  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">260</span><span>q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">260</span><span sentence-index="14888" class=""> be  a            quaternion:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">260</span><span sentence-index="14888" class="">q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">260</span><span sentence-index="14888" class=""> =  [n,  x  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">260</span><span sentence-index="14888" class="">i</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">260</span><span sentence-index="14888" class=""> +  y  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">260</span><span sentence-index="14888" class="">j</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">260</span><span sentence-index="14888" class=""> +                z  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">260</span><span sentence-index="14888" class="">k</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">260</span><span sentence-index="14888" class="">]</span></span></td></tr></tbody></table><p><a id="I_mediaobject_id371543"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">Then  each  element  in  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">R</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> is            calculated  from  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">q</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> as  follows:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">11</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span> =  n</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> +                x</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span> &#x2212;  y</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span> &#x2212;                z</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>2</span></span></sup></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">21</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> =  2xy+2zn</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">31</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> =  2zx  &#x2212;  2yn</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">12</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> =  2xy  &#x2212;  2zn</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">22</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span> =  n</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span> &#x2212;                x</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> +  y</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> &#x2212;                z</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>2</span></span></sup></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">32</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> =  2zy  +  2xn</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">13</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> =  2xz  +  2yn</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">23</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> =  2yz  &#x2212;  2xn</span></span></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">33</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> =  n</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> &#x2212;                x</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> &#x2212;  y</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span>2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class=""> +                z</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">262</span><span sentence-index="14890" class="">2</span></span></sup></td></tr></tbody></table><p><a id="I_mediaobject_id371543"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">264</span><span sentence-index="14892" class="">To  extract  the  Euler  angles,  yaw  (&#x3C8;),  pitch  (&#x3C4;),  and  roll  (&#x3C6;),            from  </span></span><span class="strong"><strong><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">264</span><span sentence-index="14892" class="">R</span></span></strong></span><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">264</span><span sentence-index="14892" class="">,  you  can  use  these            relations:</span></span></a></p><table style="border: 0; " class="simplelist"><tbody><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">264</span><span sentence-index="14892" class="">sin  &#x3C4;  =  &#x2212;r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">264</span><span sentence-index="14892" class="">31</span></span></sub></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">264</span><span sentence-index="14892" class="">tan  &#x3C6;  =  r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">264</span><span sentence-index="14892" class="">32</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">264</span><span> /                r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">264</span><span sentence-index="14892" class="">33</span></span></sub></td></tr><tr><td><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">264</span><span sentence-index="14892" class="">tan  &#x3C8;  =  r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">264</span><span sentence-index="14892" class="">21</span></span></sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">264</span><span sentence-index="14892" class=""> /                r</span></span><sub><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">264</span><span sentence-index="14892" class="">11</span></span></sub></td></tr></tbody></table><p><a id="I_mediaobject_id371543"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">266</span><span sentence-index="14894" class="">Here&apos;s  the  code  that  extracts  the  three  Euler  angles,  returned  in            the  form  of  a  </span></span><code class="literal"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">266</span><span sentence-index="14894" class="">Vector</span></span></code><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">266</span><span sentence-index="14894" class="">,  from  a  given            quaternion:</span></span></a></p><a id="I_programlisting_id371786"><pre class="programlisting">inline     Vector     MakeEulerAnglesFromQ(Quaternion q)
{
     double     r11, r21, r31, r32, r33, r12, r13;
     double     q00, q11, q22, q33;
     double     tmp;
     Vector     u;

     q00 = q.n * q.n;
     q11 = q.v.x * q.v.x;
     q22 = q.v.y * q.v.y;
     q33 = q.v.z * q.v.z;

     r11 = q00 + q11 - q22 - q33;
     r21 = 2 * (q.v.x*q.v.y + q.n*q.v.z);
     r31 = 2 * (q.v.x*q.v.z - q.n*q.v.y);
     r32 = 2 * (q.v.y*q.v.z + q.n*q.v.x);
     r33 = q00 - q11 - q22 + q33;

     tmp = fabs(r31);
     if(tmp &gt; 0.999999)
     {
          r12 = 2 * (q.v.x*q.v.y - q.n*q.v.z);
          r13 = 2 * (q.v.x*q.v.z + q.n*q.v.y);

          u.x = RadiansToDegrees(0.0f); //roll
          u.y = RadiansToDegrees((float) (-(pi/2) * r31/tmp));   // pitch
          u.z = RadiansToDegrees((float) atan2(-r12, -r31*r13)); // yaw
          return u;
     }

     u.x = RadiansToDegrees((float) atan2(r32, r33)); // roll
     u.y = RadiansToDegrees((float) asin(-r31));      // pitch
     u.z = RadiansToDegrees((float) atan2(r21, r11)); // yaw
     return u;


}</pre></a></div><div class="sect2" title="Conversion Functions"><div class="titlepage"><div><div><h3 class="title" id="conversion_functions"><a id="I_programlisting_id371786"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">269</span><span sentence-index="14897" class="">Conversion  Functions</span></span></a></h3></div></div></div><p><a id="I_programlisting_id371786"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">271</span><span sentence-index="14899" class="">These  two  functions  </span></span></a><a id="I_indexterm_id371809" class="indexterm"></a><a id="I_indexterm_id371822" class="indexterm"></a><a id="I_indexterm_id371828" class="indexterm"></a><a id="I_indexterm_id371838" class="indexterm"></a><a id="I_indexterm_id371844" class="indexterm"></a><a id="I_indexterm_id371854" class="indexterm"><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14905</span><span sentence-index="14905" class="">are  used  to  convert  angles  from  degrees  to  radians  and  radians  to  degrees. </span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">278</span><span sentence-index="14906" class=""> They                are  not  specific  to  quaternions  but  are  used  in  some  of  the  code  samples  shown  </span></span></a><a id="I_indexterm_id371863" class="indexterm"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">279</span><span sentence-index="14907" class="">earlier:</span></span></a></p><a id="I_programlisting_id371875"><pre class="programlisting">inline     float     DegreesToRadians(float deg)
{
     return deg * pi / 180.0f;
}

inline     float     RadiansToDegrees(float rad)
{
     return rad * 180.0f / pi;
}</pre></a></div></div><div class="footnotes" epub:type="footnotes"><a id="I_programlisting_id371875"><br><hr style="width: 100; align: left;"></a><div class="footnote" epub:type="footnote" id="ftn.APP-C-FN-1"><a id="I_programlisting_id371875"></a><p><a id="I_programlisting_id371875"><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">286</span><span sentence-index="14914" class="">[</span></span></sup></a><a href="#APP-C-FN-1" class="para"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">287</span><span sentence-index="14915" class="">30</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">287</span><span sentence-index="14915" class="">]  For  a  description  of  how  quaternions  are  used  to  represent  rotation,  refer  to  the                        section  </span></span><a class="xref" href="ch11.html#quaternions" title="Quaternions"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">289</span><span sentence-index="14917" class="">Quaternions</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">289</span><span sentence-index="14917" class=""> in  </span></span><a class="xref" href="ch11.html" title="Chapter&#xA0;11.&#xA0;Rotation in 3D Rigid-Body Simulators"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">290</span><span sentence-index="14918" class="">Chapter&#xA0;11</span></span></a><span class="nonQuoteStr"><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14919</span><span sentence-index="14919" class=""> .</span></span></p></div><div class="footnote" epub:type="footnote" id="ftn.APP-C-FN-2"><p><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">293</span><span sentence-index="14921" class="">[</span></span><a href="#APP-C-FN-2" class="para"><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">294</span><span sentence-index="14922" class="">31</span></span></a><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">294</span><span sentence-index="14922" class="">]  </span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">294</span><span sentence-index="14922" class="">You  can  verify  this  by  recalling  the  trigonometric  relation                    cos</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">294</span><span>2</span></span></sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">294</span><span sentence-index="14922" class="">&#x3B8;  +  sin</span></span><sup><span><span style="background-color: lightgray; padding: 4px;" class="spanSentenceIndexNumber">294</span><span sentence-index="14922" class="">2</span></span></sup><span><span style="margin-right: 5px; margin-left: 5px;" class="spanSentenceIndexNumber">14923</span><span sentence-index="14923" class="">  &#x3B8;                    =  1.</span></span></p></div></div></section>
</body></html>